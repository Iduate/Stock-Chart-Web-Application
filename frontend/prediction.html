<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ˆì¸¡í•˜ê¸° - StockChart</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“ˆ</text></svg>">

    <!-- Tailwind CSS with TradingView Color Scheme -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'tv': {
                            'darker': '#0d1421',
                            'dark': '#131722',
                            'card': '#1e222d',
                            'light': '#2a2e39',
                            'border': '#363a45',
                            'blue': '#2962ff',
                            'green': '#26a69a',
                            'red': '#ef5350',
                            'text': '#d1d4dc',
                            'text-secondary': '#868993'
                        }
                    },
                    fontFamily: {
                        'sans': ['Inter', 'Noto Sans KR', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body class="bg-tv-darker text-tv-text min-h-screen">
    <!-- Navigation Bar -->
    <nav class="bg-tv-dark border-b border-tv-border sticky top-0 z-40 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <a href="home.html"
                        class="flex items-center space-x-2 text-tv-text hover:text-tv-blue transition-colors">
                        <div class="w-8 h-8 bg-tv-blue rounded-lg flex items-center justify-center">
                            <i class="fas fa-chart-line text-white text-sm"></i>
                        </div>
                        <span class="text-xl font-bold">StockChart</span>
                    </a>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden lg:flex items-center space-x-1">
                    <a href="home.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">í™ˆ</a>
                    <a href="charts.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">ì°¨íŠ¸
                        ë³´ë“œ</a>
                    <a href="prediction.html"
                        class="px-4 py-2 rounded-lg text-tv-text bg-tv-blue bg-opacity-20 border border-tv-blue">ì˜ˆì¸¡í•˜ê¸°</a>
                    <a href="my-predictions.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">ë‚´
                        ì˜ˆì¸¡</a>
                    <a href="ranking.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">ë­í‚¹</a>
                    <a href="events.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">ì´ë²¤íŠ¸</a>
                    <a href="subscription.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">êµ¬ë…</a>
                    <button onclick="showLoginModal()"
                        class="ml-4 bg-tv-blue hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">ë¡œê·¸ì¸</button>
                </div>

                <!-- Mobile menu button -->
                <div class="lg:hidden">
                    <button onclick="toggleMobileMenu()"
                        class="relative z-[99999] text-tv-text-secondary hover:text-white p-2 rounded-lg transition-all duration-300 hover:bg-tv-light"
                        id="mobileMenuButton" aria-label="ë©”ë‰´ ì—´ê¸°">
                        <div class="w-6 h-6 flex flex-col justify-center items-center">
                            <span
                                class="hamburger-line w-6 h-0.5 bg-current transition-all duration-300 transform origin-center"></span>
                            <span
                                class="hamburger-line w-6 h-0.5 bg-current transition-all duration-300 transform origin-center mt-1.5"></span>
                            <span
                                class="hamburger-line w-6 h-0.5 bg-current transition-all duration-300 transform origin-center mt-1.5"></span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobileMenu"
        class="lg:hidden fixed inset-0 z-[9999] transform translate-x-full transition-transform duration-300 ease-in-out">
        <div class="absolute inset-0 bg-black bg-opacity-50" onclick="toggleMobileMenu()"></div>
        <div class="absolute right-0 top-0 h-full w-80 bg-tv-dark border-l border-tv-border shadow-2xl">
            <div class="p-6 space-y-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-bold text-tv-text">ë©”ë‰´</h3>
                    <button onclick="toggleMobileMenu()" class="text-tv-text-secondary hover:text-white p-2">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="space-y-3">
                    <a href="home.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-home w-5"></i>
                        <span>í™ˆ</span>
                    </a>
                    <a href="charts.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-chart-line w-5"></i>
                        <span>ì°¨íŠ¸ ë³´ë“œ</span>
                    </a>
                    <a href="prediction.html"
                        class="flex items-center space-x-3 text-tv-text bg-tv-blue bg-opacity-20 border border-tv-blue p-3 rounded-lg">
                        <i class="fas fa-lightbulb w-5"></i>
                        <span>ì˜ˆì¸¡í•˜ê¸°</span>
                    </a>
                    <a href="my-predictions.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-user-chart w-5"></i>
                        <span>ë‚´ ì˜ˆì¸¡</span>
                    </a>
                    <a href="ranking.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-trophy w-5"></i>
                        <span>ë­í‚¹</span>
                    </a>
                    <a href="events.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-calendar w-5"></i>
                        <span>ì´ë²¤íŠ¸</span>
                    </a>
                    <a href="subscription.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-crown w-5"></i>
                        <span>êµ¬ë…</span>
                    </a>
                </div>
                <div class="pt-6 border-t border-tv-border">
                    <button onclick="showLoginModal()"
                        class="w-full bg-tv-blue hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
                        <i class="fas fa-sign-in-alt mr-2"></i>
                        ë¡œê·¸ì¸
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="py-8 bg-tv-darker min-h-screen">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Page Header -->
            <div class="mb-8 text-center">
                <h1 class="text-4xl font-bold text-tv-text mb-4">ì£¼ì‹ ì˜ˆì¸¡í•˜ê¸°</h1>
                <p class="text-lg text-tv-text-secondary">ì¢…ëª©ì„ ì„ íƒí•˜ê³  ì˜ˆì¸¡ ì •ë³´ë¥¼ ì…ë ¥í•˜ì—¬ ì˜ˆì¸¡ì„ ë°œí–‰í•˜ì„¸ìš”</p>
            </div>

            <!-- Main Form -->
            <div class="bg-tv-card border border-tv-border rounded-2xl p-8 shadow-xl">
                <form id="predictionForm" class="space-y-8">

                    <!-- Step 1: Stock Selection -->
                    <div class="space-y-4">
                        <label class="block text-lg font-semibold text-tv-text">
                            <i class="fas fa-chart-line text-tv-blue mr-2"></i>ì¢…ëª© ì„ íƒ
                        </label>

                        <!-- Stock Search -->
                        <input type="text" id="stockSearch"
                            class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-blue focus:border-tv-blue transition-all"
                            placeholder="ì¢…ëª©ëª… ë˜ëŠ” ì‹¬ë³¼ ê²€ìƒ‰ (ì˜ˆ: AAPL, TSLA, BTC)">

                        <!-- Stock Selection Dropdown -->
                        <select id="stockSelect" name="stock_symbol" required
                            class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-blue focus:border-tv-blue transition-all">
                            <option value="">ì¢…ëª©ì„ ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="AAPL">AAPL - Apple Inc.</option>
                            <option value="MSFT">MSFT - Microsoft Corporation</option>
                            <option value="GOOGL">GOOGL - Alphabet Inc.</option>
                            <option value="TSLA">TSLA - Tesla Inc.</option>
                            <option value="AMZN">AMZN - Amazon.com Inc.</option>
                            <option value="NVDA">NVDA - NVIDIA Corporation</option>
                            <option value="META">META - Meta Platforms Inc.</option>
                            <option value="BTC">BTC - Bitcoin</option>
                            <option value="ETH">ETH - Ethereum</option>
                        </select>

                        <!-- Current Stock Info Display -->
                        <div id="stockInfo" class="hidden bg-tv-light/50 border border-tv-border rounded-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 id="selectedStockName" class="text-xl font-semibold text-tv-text"></h3>
                                    <p id="selectedStockSymbol" class="text-tv-text-secondary"></p>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm text-tv-text-secondary">í˜„ì¬ ê°€ê²©</p>
                                    <p id="currentStockPrice" class="text-3xl font-bold text-tv-text">$0.00</p>
                                    <p id="loadingPrice" class="text-sm text-tv-blue">
                                        <i class="fas fa-spinner fa-spin mr-1"></i>ê°€ê²© ë¡œë”© ì¤‘...
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Price Prediction -->
                    <div class="space-y-4">
                        <label class="block text-lg font-semibold text-tv-text">
                            <i class="fas fa-dollar-sign text-tv-green mr-2"></i>ì˜ˆì¸¡ ì •ë³´
                        </label>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Current Price (Auto-filled) -->
                            <div>
                                <label class="block text-sm font-medium text-tv-text-secondary mb-2">í˜„ì¬ ê°€ê²©</label>
                                <input type="number" id="currentPrice" name="current_price" step="0.01" readonly
                                    class="w-full px-4 py-3 bg-tv-darker border border-tv-border rounded-lg text-tv-text cursor-not-allowed"
                                    placeholder="ì¢…ëª© ì„ íƒ í›„ ìë™ ì…ë ¥">
                            </div>

                            <!-- Predicted Price (User Input) -->
                            <div>
                                <label class="block text-sm font-medium text-tv-text-secondary mb-2">ì˜ˆì¸¡ ê°€ê²©</label>
                                <input type="number" id="predictedPrice" name="predicted_price" step="0.01" required
                                    class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-green focus:border-tv-green transition-all"
                                    placeholder="ì˜ˆì¸¡í•˜ëŠ” ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš”">
                            </div>
                        </div>

                        <!-- Price Change Indicator -->
                        <div id="priceChangeIndicator"
                            class="hidden bg-tv-light/30 border border-tv-border rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <span class="text-tv-text-secondary">ì˜ˆìƒ ë³€í™”ìœ¨:</span>
                                <span id="priceChangePercent" class="font-bold text-lg"></span>
                                <span id="priceChangeDirection" class="text-sm font-medium"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Time Period -->
                    <div class="space-y-4">
                        <label class="block text-lg font-semibold text-tv-text">
                            <i class="fas fa-calendar text-tv-blue mr-2"></i>ì˜ˆì¸¡ ê¸°ê°„
                        </label>

                        <select id="predictionDays" name="prediction_days" required
                            class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-blue focus:border-tv-blue transition-all">
                            <option value="">ì˜ˆì¸¡ ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="1">1ì¼</option>
                            <option value="3">3ì¼</option>
                            <option value="7">7ì¼ (1ì£¼ì¼)</option>
                            <option value="14">14ì¼ (2ì£¼ì¼)</option>
                            <option value="30">30ì¼ (1ê°œì›”)</option>
                        </select>

                        <!-- Target Date Display -->
                        <div id="targetDateDisplay"
                            class="hidden bg-tv-light/30 border border-tv-border rounded-lg p-3">
                            <div class="flex items-center justify-between">
                                <span class="text-tv-text-secondary">ëª©í‘œ ë‚ ì§œ:</span>
                                <span id="targetDateText" class="font-semibold text-tv-text"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Optional: Analysis/Reasoning -->
                    <div class="space-y-4">
                        <label class="block text-lg font-semibold text-tv-text">
                            <i class="fas fa-lightbulb text-orange-500 mr-2"></i>ì˜ˆì¸¡ ê·¼ê±° (ì„ íƒì‚¬í•­)
                        </label>

                        <textarea id="predictionReason" name="reasoning" rows="3"
                            class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-blue focus:border-tv-blue transition-all resize-none"
                            placeholder="ì˜ˆì¸¡ì˜ ê·¼ê±°ë‚˜ ë¶„ì„ ë‚´ìš©ì„ ê°„ë‹¨íˆ ì‘ì„±í•´ì£¼ì„¸ìš” (ì„ íƒì‚¬í•­)"></textarea>
                    </div>

                    <!-- Submit Button -->
                    <div class="pt-6">
                        <button type="submit" id="submitPrediction"
                            class="w-full bg-gradient-to-r from-tv-blue to-blue-600 hover:from-blue-600 hover:to-tv-blue text-white font-bold py-4 px-8 rounded-lg transition-all duration-300 transform hover:scale-[1.02] hover:shadow-lg hover:shadow-tv-blue/20 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:hover:shadow-none">
                            <i class="fas fa-rocket mr-2"></i>
                            <span id="submitButtonText">ì˜ˆì¸¡ ë°œí–‰í•˜ê¸°</span>
                        </button>
                    </div>

                </form>
            </div>

            <!-- Success Message -->
            <div id="successMessage"
                class="hidden mt-8 bg-tv-green/20 border border-tv-green/30 rounded-lg p-6 text-center">
                <div class="flex items-center justify-center mb-4">
                    <div class="w-16 h-16 bg-tv-green/20 rounded-full flex items-center justify-center">
                        <i class="fas fa-check text-tv-green text-2xl"></i>
                    </div>
                </div>
                <h3 class="text-xl font-bold text-tv-green mb-2">ì˜ˆì¸¡ì´ ì„±ê³µì ìœ¼ë¡œ ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤!</h3>
                <p class="text-tv-text-secondary mb-4">ì˜ˆì¸¡ì´ ì €ì¥ë˜ì—ˆìœ¼ë©° ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                <div class="flex gap-4 justify-center">
                    <button onclick="resetForm()"
                        class="bg-tv-blue hover:bg-blue-600 text-white px-6 py-2 rounded-lg transition-colors">
                        ìƒˆ ì˜ˆì¸¡ ì‘ì„±
                    </button>
                    <a href="my-predictions.html"
                        class="bg-tv-green hover:bg-green-600 text-white px-6 py-2 rounded-lg transition-colors">
                        ë‚´ ì˜ˆì¸¡ ë³´ê¸°
                    </a>
                </div>
            </div>

        </div>
    </main>

    <!-- JavaScript -->
    <script>
        // Stock data for simulation
        const stockData = {
            'AAPL': { name: 'Apple Inc.', symbol: 'AAPL', price: 238.71 },
            'MSFT': { name: 'Microsoft Corporation', symbol: 'MSFT', price: 415.23 },
            'GOOGL': { name: 'Alphabet Inc.', symbol: 'GOOGL', price: 165.84 },
            'TSLA': { name: 'Tesla Inc.', symbol: 'TSLA', price: 248.50 },
            'AMZN': { name: 'Amazon.com Inc.', symbol: 'AMZN', price: 186.29 },
            'NVDA': { name: 'NVIDIA Corporation', symbol: 'NVDA', price: 875.42 },
            'META': { name: 'Meta Platforms Inc.', symbol: 'META', price: 542.81 },
            'BTC': { name: 'Bitcoin', symbol: 'BTC', price: 51250.00 },
            'ETH': { name: 'Ethereum', symbol: 'ETH', price: 2435.67 }
        };

        // DOM elements
        const stockSearch = document.getElementById('stockSearch');
        const stockSelect = document.getElementById('stockSelect');
        const stockInfo = document.getElementById('stockInfo');
        const selectedStockName = document.getElementById('selectedStockName');
        const selectedStockSymbol = document.getElementById('selectedStockSymbol');
        const currentStockPrice = document.getElementById('currentStockPrice');
        const loadingPrice = document.getElementById('loadingPrice');
        const currentPrice = document.getElementById('currentPrice');
        const predictedPrice = document.getElementById('predictedPrice');
        const priceChangeIndicator = document.getElementById('priceChangeIndicator');
        const priceChangePercent = document.getElementById('priceChangePercent');
        const priceChangeDirection = document.getElementById('priceChangeDirection');
        const predictionDays = document.getElementById('predictionDays');
        const targetDateDisplay = document.getElementById('targetDateDisplay');
        const targetDateText = document.getElementById('targetDateText');
        const predictionForm = document.getElementById('predictionForm');
        const submitButton = document.getElementById('submitPrediction');
        const submitButtonText = document.getElementById('submitButtonText');
        const successMessage = document.getElementById('successMessage');

        // Stock search functionality
        stockSearch.addEventListener('input', function () {
            const searchTerm = this.value.toLowerCase();
            const options = stockSelect.querySelectorAll('option');

            options.forEach(option => {
                if (option.value === '') return;
                const text = option.textContent.toLowerCase();
                option.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Stock selection handler
        stockSelect.addEventListener('change', function () {
            const selectedSymbol = this.value;

            if (selectedSymbol && stockData[selectedSymbol]) {
                loadingPrice.style.display = 'block';
                currentStockPrice.textContent = '$0.00';

                // Show stock info
                stockInfo.classList.remove('hidden');

                // Simulate loading delay
                setTimeout(() => {
                    const stock = stockData[selectedSymbol];

                    selectedStockName.textContent = stock.name;
                    selectedStockSymbol.textContent = stock.symbol;
                    currentStockPrice.textContent = `$${stock.price.toLocaleString()}`;
                    currentPrice.value = stock.price;

                    loadingPrice.style.display = 'none';

                    // Trigger price change calculation if predicted price exists
                    if (predictedPrice.value) {
                        calculatePriceChange();
                    }
                }, 1000);
            } else {
                stockInfo.classList.add('hidden');
                currentPrice.value = '';
                priceChangeIndicator.classList.add('hidden');
            }
        });

        // Predicted price input handler
        predictedPrice.addEventListener('input', calculatePriceChange);

        function calculatePriceChange() {
            const current = parseFloat(currentPrice.value);
            const predicted = parseFloat(predictedPrice.value);

            if (current && predicted) {
                const changePercent = ((predicted - current) / current) * 100;
                const isPositive = changePercent >= 0;

                priceChangePercent.textContent = `${isPositive ? '+' : ''}${changePercent.toFixed(2)}%`;
                priceChangePercent.className = `font-bold text-lg ${isPositive ? 'text-tv-green' : 'text-tv-red'}`;

                priceChangeDirection.textContent = isPositive ? 'ğŸ“ˆ ìƒìŠ¹ ì˜ˆì¸¡' : 'ğŸ“‰ í•˜ë½ ì˜ˆì¸¡';
                priceChangeDirection.className = `text-sm font-medium ${isPositive ? 'text-tv-green' : 'text-tv-red'}`;

                priceChangeIndicator.classList.remove('hidden');
            } else {
                priceChangeIndicator.classList.add('hidden');
            }
        }

        // Prediction days change handler
        predictionDays.addEventListener('change', function () {
            const days = parseInt(this.value);

            if (days) {
                const targetDate = new Date();
                targetDate.setDate(targetDate.getDate() + days);

                const options = {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'long'
                };

                targetDateText.textContent = targetDate.toLocaleDateString('ko-KR', options);
                targetDateDisplay.classList.remove('hidden');
            } else {
                targetDateDisplay.classList.add('hidden');
            }
        });

        // Form submission handler
        predictionForm.addEventListener('submit', async function (e) {
            e.preventDefault();

            // Disable submit button
            submitButton.disabled = true;
            submitButtonText.textContent = 'ë°œí–‰ ì¤‘...';
            submitButton.querySelector('i').className = 'fas fa-spinner fa-spin mr-2';

            try {
                // Calculate target date
                const targetDate = new Date();
                targetDate.setDate(targetDate.getDate() + parseInt(predictionDays.value));

                const formData = {
                    stock_symbol: stockSelect.value,
                    current_price: parseFloat(currentPrice.value),
                    predicted_price: parseFloat(predictedPrice.value),
                    target_date: targetDate.toISOString().split('T')[0], // YYYY-MM-DD format
                    reasoning: document.getElementById('predictionReason').value || 'User prediction',
                    confidence: 75
                };

                console.log('Submitting prediction:', formData);

                // Submit to API
                const response = await fetch('/api/charts/predictions/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken') || '',
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    const result = await response.json();
                    console.log('Prediction created:', result);

                    // Show success message
                    predictionForm.style.display = 'none';
                    successMessage.classList.remove('hidden');
                } else {
                    const error = await response.json();
                    throw new Error(error.detail || 'Failed to create prediction');
                }

            } catch (error) {
                console.error('Error submitting prediction:', error);
                alert('ì˜ˆì¸¡ ë°œí–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            } finally {
                // Re-enable submit button
                submitButton.disabled = false;
                submitButtonText.textContent = 'ì˜ˆì¸¡ ë°œí–‰í•˜ê¸°';
                submitButton.querySelector('i').className = 'fas fa-rocket mr-2';
            }
        });

        // Reset form function
        function resetForm() {
            predictionForm.reset();
            stockInfo.classList.add('hidden');
            priceChangeIndicator.classList.add('hidden');
            targetDateDisplay.classList.add('hidden');
            successMessage.classList.add('hidden');
            predictionForm.style.display = 'block';
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            console.log('Prediction page loaded');
        });

        // CSRF Token helper function
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Mobile menu functions
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileMenuButton = document.getElementById('mobileMenuButton');

            if (mobileMenu.classList.contains('translate-x-full')) {
                // Open menu
                mobileMenu.classList.remove('translate-x-full');
                mobileMenu.classList.add('translate-x-0');
                mobileMenuButton.classList.add('menu-open');
                document.body.style.overflow = 'hidden';
            } else {
                // Close menu
                mobileMenu.classList.remove('translate-x-0');
                mobileMenu.classList.add('translate-x-full');
                mobileMenuButton.classList.remove('menu-open');
                document.body.style.overflow = 'auto';
            }
        }

        // Login modal function (placeholder)
        function showLoginModal() {
            alert('ë¡œê·¸ì¸ ê¸°ëŠ¥ì€ ê³§ êµ¬í˜„ë  ì˜ˆì •ì…ë‹ˆë‹¤.');
        }

        // Add hamburger menu animation styles
        const style = document.createElement('style');
        style.textContent = `
            .hamburger-line {
                transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            }
            
            .menu-open .hamburger-line:nth-child(1) {
                transform: rotate(45deg) translate(6px, 6px);
            }
            
            .menu-open .hamburger-line:nth-child(2) {
                opacity: 0;
                transform: scale(0);
            }
            
            .menu-open .hamburger-line:nth-child(3) {
                transform: rotate(-45deg) translate(6px, -6px);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>

</html>