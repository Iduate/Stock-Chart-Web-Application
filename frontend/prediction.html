<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>예측하기 - StockChart</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📈</text></svg>">

    <!-- Tailwind CSS with TradingView Color Scheme -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'tv': {
                            'darker': '#0d1421',
                            'dark': '#131722',
                            'card': '#1e222d',
                            'light': '#2a2e39',
                            'border': '#363a45',
                            'blue': '#2962ff',
                            'green': '#26a69a',
                            'red': '#ef5350',
                            'text': '#d1d4dc',
                            'text-secondary': '#868993'
                        }
                    },
                    fontFamily: {
                        'sans': ['Inter', 'Noto Sans KR', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body class="bg-tv-darker text-tv-text min-h-screen">
    <!-- Navigation Bar -->
    <nav class="bg-tv-dark border-b border-tv-border sticky top-0 z-40 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <a href="home.html"
                        class="flex items-center space-x-2 text-tv-text hover:text-tv-blue transition-colors">
                        <div class="w-8 h-8 bg-tv-blue rounded-lg flex items-center justify-center">
                            <i class="fas fa-chart-line text-white text-sm"></i>
                        </div>
                        <span class="text-xl font-bold">StockChart</span>
                    </a>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden lg:flex items-center space-x-1">
                    <a href="home.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">홈</a>
                    <a href="charts.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">차트
                        보드</a>
                    <a href="prediction.html"
                        class="px-4 py-2 rounded-lg text-tv-text bg-tv-blue bg-opacity-20 border border-tv-blue">예측하기</a>
                    <a href="my-predictions.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">내
                        예측</a>
                    <a href="ranking.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">랭킹</a>
                    <a href="events.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">이벤트</a>
                    <a href="subscription.html"
                        class="px-4 py-2 rounded-lg text-tv-text-secondary hover:text-tv-text hover:bg-tv-light transition-all duration-200">구독</a>
                    <button onclick="showLoginModal()"
                        class="ml-4 bg-tv-blue hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">로그인</button>
                </div>

                <!-- Mobile menu button -->
                <div class="lg:hidden">
                    <button onclick="toggleMobileMenu()"
                        class="relative z-[99999] text-tv-text-secondary hover:text-white p-2 rounded-lg transition-all duration-300 hover:bg-tv-light"
                        id="mobileMenuButton" aria-label="메뉴 열기">
                        <div class="w-6 h-6 flex flex-col justify-center items-center">
                            <span
                                class="hamburger-line w-6 h-0.5 bg-current transition-all duration-300 transform origin-center"></span>
                            <span
                                class="hamburger-line w-6 h-0.5 bg-current transition-all duration-300 transform origin-center mt-1.5"></span>
                            <span
                                class="hamburger-line w-6 h-0.5 bg-current transition-all duration-300 transform origin-center mt-1.5"></span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobileMenu"
        class="lg:hidden fixed inset-0 z-[9999] transform translate-x-full transition-transform duration-300 ease-in-out">
        <div class="absolute inset-0 bg-black bg-opacity-50" onclick="toggleMobileMenu()"></div>
        <div class="absolute right-0 top-0 h-full w-80 bg-tv-dark border-l border-tv-border shadow-2xl">
            <div class="p-6 space-y-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-bold text-tv-text">메뉴</h3>
                    <button onclick="toggleMobileMenu()" class="text-tv-text-secondary hover:text-white p-2">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="space-y-3">
                    <a href="home.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-home w-5"></i>
                        <span>홈</span>
                    </a>
                    <a href="charts.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-chart-line w-5"></i>
                        <span>차트 보드</span>
                    </a>
                    <a href="prediction.html"
                        class="flex items-center space-x-3 text-tv-text bg-tv-blue bg-opacity-20 border border-tv-blue p-3 rounded-lg">
                        <i class="fas fa-lightbulb w-5"></i>
                        <span>예측하기</span>
                    </a>
                    <a href="my-predictions.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-user-chart w-5"></i>
                        <span>내 예측</span>
                    </a>
                    <a href="ranking.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-trophy w-5"></i>
                        <span>랭킹</span>
                    </a>
                    <a href="events.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-calendar w-5"></i>
                        <span>이벤트</span>
                    </a>
                    <a href="subscription.html"
                        class="flex items-center space-x-3 text-tv-text-secondary hover:text-tv-text p-3 rounded-lg hover:bg-tv-light transition-all duration-200">
                        <i class="fas fa-crown w-5"></i>
                        <span>구독</span>
                    </a>
                </div>
                <div class="pt-6 border-t border-tv-border">
                    <button onclick="showLoginModal()"
                        class="w-full bg-tv-blue hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
                        <i class="fas fa-sign-in-alt mr-2"></i>
                        로그인
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="py-8 bg-tv-darker min-h-screen">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Page Header -->
            <div class="mb-8 text-center">
                <h1 class="text-4xl font-bold text-tv-text mb-4">주식 예측하기</h1>
                <p class="text-lg text-tv-text-secondary">종목을 선택하고 예측 정보를 입력하여 예측을 발행하세요</p>
            </div>

            <!-- Main Form -->
            <div class="bg-tv-card border border-tv-border rounded-2xl p-8 shadow-xl">
                <form id="predictionForm" class="space-y-8">

                    <!-- Step 1: Stock Selection -->
                    <div class="space-y-4">
                        <label class="block text-lg font-semibold text-tv-text">
                            <i class="fas fa-chart-line text-tv-blue mr-2"></i>종목 선택
                        </label>

                        <!-- Stock Search -->
                        <input type="text" id="stockSearch"
                            class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-blue focus:border-tv-blue transition-all"
                            placeholder="종목명 또는 심볼 검색 (예: AAPL, TSLA, BTC)">

                        <!-- Stock Selection Dropdown -->
                        <select id="stockSelect" name="stock_symbol" required
                            class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-blue focus:border-tv-blue transition-all">
                            <option value="">종목을 선택하세요</option>

                            <!-- US Stocks -->
                            <optgroup label="🇺🇸 미국 주식">
                                <option value="AAPL">AAPL - 애플</option>
                                <option value="MSFT">MSFT - 마이크로소프트</option>
                                <option value="GOOGL">GOOGL - 구글 (알파벳)</option>
                                <option value="AMZN">AMZN - 아마존</option>
                                <option value="TSLA">TSLA - 테슬라</option>
                                <option value="NVDA">NVDA - 엔비디아</option>
                                <option value="META">META - 메타 (페이스북)</option>
                                <option value="NFLX">NFLX - 넷플릭스</option>
                                <option value="CRM">CRM - 세일즈포스</option>
                                <option value="PYPL">PYPL - 페이팔</option>
                                <option value="ADBE">ADBE - 어도비</option>
                                <option value="INTC">INTC - 인텔</option>
                                <option value="AMD">AMD - AMD</option>
                                <option value="CSCO">CSCO - 시스코</option>
                                <option value="ORCL">ORCL - 오라클</option>
                                <option value="IBM">IBM - IBM</option>
                                <option value="UBER">UBER - 우버</option>
                                <option value="SPOT">SPOT - 스포티파이</option>
                                <option value="ZM">ZM - 줌</option>
                                <option value="SQ">SQ - 블록 (스퀘어)</option>
                                <option value="V">V - 비자</option>
                                <option value="MA">MA - 마스터카드</option>
                                <option value="JPM">JPM - JP모건</option>
                                <option value="JNJ">JNJ - 존슨앤존슨</option>
                                <option value="WMT">WMT - 월마트</option>
                                <option value="PG">PG - 프록터앤갬블</option>
                                <option value="UNH">UNH - 유나이티드헬스</option>
                                <option value="HD">HD - 홈디포</option>
                                <option value="BAC">BAC - 뱅크오브아메리카</option>
                                <option value="DIS">DIS - 디즈니</option>
                                <option value="ADBE">ADBE - 어도비</option>
                                <option value="CRM">CRM - 세일즈포스</option>
                                <option value="NOW">NOW - 서비스나우</option>
                                <option value="BABA">BABA - 알리바바</option>
                                <option value="PFE">PFE - 화이자</option>
                                <option value="KO">KO - 코카콜라</option>
                                <option value="PEP">PEP - 펩시코</option>
                                <option value="TMO">TMO - 써모피셔</option>
                                <option value="ABT">ABT - 애벗</option>
                                <option value="COST">COST - 코스트코</option>
                                <option value="AVGO">AVGO - 브로드컴</option>
                                <option value="TXN">TXN - 텍사스인스트루먼트</option>
                                <option value="QCOM">QCOM - 퀄컴</option>
                                <option value="LLY">LLY - 일라이릴리</option>
                                <option value="XOM">XOM - 엑손모빌</option>
                                <option value="CVX">CVX - 셰브론</option>
                                <option value="ABBV">ABBV - 애비</option>
                                <option value="MRK">MRK - 머크</option>
                                <option value="ACN">ACN - 액센츄어</option>
                                <option value="ORCL">ORCL - 오라클</option>
                                <option value="VZ">VZ - 버라이즌</option>
                                <option value="T">T - AT&T</option>
                                <option value="CMCSA">CMCSA - 컴캐스트</option>
                                <option value="MDT">MDT - 메드트로닉</option>
                                <option value="NEE">NEE - 넥스트에라에너지</option>
                            </optgroup>

                            <!-- Korean Stocks -->
                            <optgroup label="🇰🇷 한국 주식">
                                <option value="005930.KS">005930.KS - 삼성전자</option>
                                <option value="000660.KS">000660.KS - SK하이닉스</option>
                                <option value="035420.KS">035420.KS - 네이버</option>
                                <option value="207940.KS">207940.KS - 삼성바이오로직스</option>
                                <option value="006400.KS">006400.KS - 삼성SDI</option>
                                <option value="051910.KS">051910.KS - LG화학</option>
                                <option value="096770.KS">096770.KS - SK이노베이션</option>
                                <option value="028260.KS">028260.KS - 삼성물산</option>
                                <option value="034730.KS">034730.KS - SK</option>
                                <option value="068270.KS">068270.KS - 셀트리온</option>
                                <option value="323410.KS">323410.KS - 카카오뱅크</option>
                                <option value="035720.KS">035720.KS - 카카오</option>
                                <option value="352820.KS">352820.KS - 하이브</option>
                                <option value="003670.KS">003670.KS - 포스코홀딩스</option>
                                <option value="105560.KS">105560.KS - KB금융</option>
                                <option value="055550.KS">055550.KS - 신한지주</option>
                                <option value="086790.KS">086790.KS - 하나금융지주</option>
                                <option value="017670.KS">017670.KS - SK텔레콤</option>
                                <option value="030200.KS">030200.KS - KT</option>
                                <option value="032830.KS">032830.KS - 삼성생명</option>
                                <option value="009150.KS">009150.KS - 삼성전기</option>
                                <option value="000270.KS">000270.KS - 기아</option>
                                <option value="005380.KS">005380.KS - 현대차</option>
                                <option value="012330.KS">012330.KS - 현대모비스</option>
                                <option value="066570.KS">066570.KS - LG전자</option>
                                <option value="003550.KS">003550.KS - LG</option>
                                <option value="018260.KS">018260.KS - 삼성에스디에스</option>
                                <option value="361610.KS">361610.KS - SK아이이테크놀로지</option>
                                <option value="247540.KS">247540.KS - 에코프로비엠</option>
                                <option value="373220.KS">373220.KS - LG에너지솔루션</option>
                                <option value="036570.KS">036570.KS - 엔씨소프트</option>
                                <option value="251270.KS">251270.KS - 넷마블</option>
                                <option value="112040.KS">112040.KS - 위메이드</option>
                                <option value="259960.KS">259960.KS - 크래프톤</option>
                                <option value="035900.KS">035900.KS - JYP Ent.</option>
                                <option value="122870.KS">122870.KS - 와이지엔터테인먼트</option>
                                <option value="041510.KS">041510.KS - 에스엠</option>
                                <option value="000810.KS">000810.KS - 삼성화재</option>
                                <option value="024110.KS">024110.KS - 기업은행</option>
                                <option value="316140.KS">316140.KS - 우리금융지주</option>
                                <option value="128940.KS">128940.KS - 한미약품</option>
                                <option value="196170.KS">196170.KS - 알테오젠</option>
                                <option value="068760.KS">068760.KS - 셀트리온제약</option>
                                <option value="091990.KS">091990.KS - 셀트리온헬스케어</option>
                                <option value="207940.KS">207940.KS - 삼성바이오로직스</option>
                                <option value="302440.KS">302440.KS - SK바이오사이언스</option>
                            </optgroup>

                            <!-- Japanese Stocks -->
                            <optgroup label="🇯🇵 일본 주식">
                                <option value="7203.T">7203.T - 도요타자동차</option>
                                <option value="6758.T">6758.T - 소니그룹</option>
                                <option value="9984.T">9984.T - 소프트뱅크그룹</option>
                                <option value="6501.T">6501.T - 히타치</option>
                                <option value="8306.T">8306.T - 미쓰비시UFJ은행</option>
                                <option value="4502.T">4502.T - 다케다제약</option>
                                <option value="7974.T">7974.T - 닌텐도</option>
                                <option value="6861.T">6861.T - 키엔스</option>
                                <option value="4519.T">4519.T - 추가이제약</option>
                                <option value="8035.T">8035.T - 도쿄일렉트론</option>
                                <option value="9432.T">9432.T - NTT</option>
                                <option value="4661.T">4661.T - 오리엔탈랜드</option>
                                <option value="6954.T">6954.T - 파낙</option>
                                <option value="7751.T">7751.T - 캐논</option>
                                <option value="8031.T">8031.T - 미쓰이물산</option>
                                <option value="9434.T">9434.T - 소프트뱅크</option>
                                <option value="4568.T">4568.T - 다이이치산쿄</option>
                                <option value="8058.T">8058.T - 미쓰비시상사</option>
                                <option value="9433.T">9433.T - KDDI</option>
                                <option value="4063.T">4063.T - 신에쓰화학</option>
                                <option value="6098.T">6098.T - 리쿠루트홀딩스</option>
                                <option value="7267.T">7267.T - 혼다기연</option>
                                <option value="8766.T">8766.T - 도쿄해상</option>
                                <option value="4911.T">4911.T - 시세이도</option>
                                <option value="2914.T">2914.T - JT</option>
                            </optgroup>

                            <!-- Indian Stocks -->
                            <optgroup label="🇮🇳 인도 주식">
                                <option value="RELIANCE.NS">RELIANCE.NS - 릴라이언스인더스트리</option>
                                <option value="TCS.NS">TCS.NS - 타타컨설턴시서비스</option>
                                <option value="HDFCBANK.NS">HDFCBANK.NS - HDFC은행</option>
                                <option value="INFY.NS">INFY.NS - 인포시스</option>
                                <option value="HINDUNILVR.NS">HINDUNILVR.NS - 힌두스탄유니레버</option>
                                <option value="ICICIBANK.NS">ICICIBANK.NS - ICICI은행</option>
                                <option value="SBIN.NS">SBIN.NS - 인도국립은행</option>
                                <option value="BHARTIARTL.NS">BHARTIARTL.NS - 바르티에어텔</option>
                                <option value="ITC.NS">ITC.NS - ITC</option>
                                <option value="KOTAKBANK.NS">KOTAKBANK.NS - 코탁마힌드라은행</option>
                                <option value="LT.NS">LT.NS - 라슨앤투브로</option>
                                <option value="ASIANPAINT.NS">ASIANPAINT.NS - 아시안페인트</option>
                                <option value="MARUTI.NS">MARUTI.NS - 마루티스즈키</option>
                                <option value="AXISBANK.NS">AXISBANK.NS - 액시스은행</option>
                                <option value="WIPRO.NS">WIPRO.NS - 위프로</option>
                                <option value="HCLTECH.NS">HCLTECH.NS - HCL테크놀로지</option>
                                <option value="BAJFINANCE.NS">BAJFINANCE.NS - 바즈파이낸스</option>
                                <option value="SUNPHARMA.NS">SUNPHARMA.NS - 선파마</option>
                                <option value="TECHM.NS">TECHM.NS - 테크마힌드라</option>
                                <option value="TITAN.NS">TITAN.NS - 타이탄</option>
                                <option value="ULTRACEMCO.NS">ULTRACEMCO.NS - 울트라테크시멘트</option>
                                <option value="NESTLEIND.NS">NESTLEIND.NS - 네슬레인디아</option>
                                <option value="POWERGRID.NS">POWERGRID.NS - 파워그리드</option>
                                <option value="NTPC.NS">NTPC.NS - NTPC</option>
                                <option value="COALINDIA.NS">COALINDIA.NS - 콜인디아</option>
                            </optgroup> <!-- UK Stocks -->
                            <optgroup label="🇬🇧 영국 주식">
                                <option value="AZN.L">AZN.L - 아스트라제네카</option>
                                <option value="SHEL.L">SHEL.L - 셸</option>
                                <option value="ULVR.L">ULVR.L - 유니레버</option>
                                <option value="BP.L">BP.L - BP</option>
                                <option value="HSBA.L">HSBA.L - HSBC홀딩스</option>
                                <option value="GSK.L">GSK.L - GSK</option>
                                <option value="DGE.L">DGE.L - 디아지오</option>
                                <option value="RIO.L">RIO.L - 리오틴토</option>
                                <option value="BT-A.L">BT-A.L - BT그룹</option>
                                <option value="LLOY.L">LLOY.L - 로이즈뱅킹그룹</option>
                                <option value="BARC.L">BARC.L - 바클레이스</option>
                                <option value="VOD.L">VOD.L - 보다폰그룹</option>
                                <option value="NWG.L">NWG.L - 네이션와이드그룹</option>
                                <option value="GLEN.L">GLEN.L - 글렌코어</option>
                                <option value="TSCO.L">TSCO.L - 테스코</option>
                            </optgroup>

                            <!-- Canadian Stocks -->
                            <optgroup label="🇨🇦 캐나다 주식">
                                <option value="SHOP.TO">SHOP.TO - 쇼피파이</option>
                                <option value="RY.TO">RY.TO - 로열뱅크오브캐나다</option>
                                <option value="TD.TO">TD.TO - 토론토도미니언은행</option>
                                <option value="BNS.TO">BNS.TO - 뱅크오브노바스코샤</option>
                                <option value="BMO.TO">BMO.TO - 뱅크오브몬트리올</option>
                                <option value="CNR.TO">CNR.TO - 캐나디언내셔널철도</option>
                                <option value="CP.TO">CP.TO - 캐나디언퍼시픽철도</option>
                                <option value="CNQ.TO">CNQ.TO - 캐나디언내추럴리소스</option>
                                <option value="SU.TO">SU.TO - 선코어에너지</option>
                                <option value="TRI.TO">TRI.TO - 톰슨로이터</option>
                                <option value="ENB.TO">ENB.TO - 엔브리지</option>
                                <option value="WN.TO">WN.TO - 조지웨스턴</option>
                                <option value="CSU.TO">CSU.TO - 컨스텔레이션소프트웨어</option>
                                <option value="ATD.TO">ATD.TO - 알리멘테이션쿠셰타드</option>
                                <option value="CCL-B.TO">CCL-B.TO - CCL인더스트리</option>
                            </optgroup>

                            <!-- French Stocks -->
                            <optgroup label="🇫🇷 프랑스 주식">
                                <option value="MC.PA">MC.PA - LVMH</option>
                                <option value="OR.PA">OR.PA - 로레알</option>
                                <option value="SAN.PA">SAN.PA - 사노피</option>
                                <option value="ASML.PA">ASML.PA - ASML홀딩</option>
                                <option value="TTE.PA">TTE.PA - 토탈에너지</option>
                                <option value="BNP.PA">BNP.PA - BNP파리바</option>
                                <option value="ACA.PA">ACA.PA - 크레디트아그리콜</option>
                                <option value="AI.PA">AI.PA - 에어리퀴드</option>
                                <option value="DG.PA">DG.PA - 빈치</option>
                                <option value="BN.PA">BN.PA - 다논</option>
                                <option value="CAP.PA">CAP.PA - 캡제미니</option>
                                <option value="KER.PA">KER.PA - 케링</option>
                                <option value="RNO.PA">RNO.PA - 르노</option>
                                <option value="SU.PA">SU.PA - 슈나이더일렉트릭</option>
                                <option value="AIR.PA">AIR.PA - 에어버스</option>
                            </optgroup>

                            <!-- German Stocks -->
                            <optgroup label="🇩🇪 독일 주식">
                                <option value="SAP.DE">SAP.DE - SAP</option>
                                <option value="ASME.DE">ASME.DE - ASML홀딩</option>
                                <option value="SIE.DE">SIE.DE - 지멘스</option>
                                <option value="ADS.DE">ADS.DE - 아디다스</option>
                                <option value="ALV.DE">ALV.DE - 알리안츠</option>
                                <option value="BAS.DE">BAS.DE - BASF</option>
                                <option value="BMW.DE">BMW.DE - BMW</option>
                                <option value="DAI.DE">DAI.DE - 메르세데스벤츠그룹</option>
                                <option value="VOW3.DE">VOW3.DE - 폭스바겐</option>
                                <option value="DBK.DE">DBK.DE - 도이체뱅크</option>
                                <option value="MUV2.DE">MUV2.DE - 뮌헨재보험</option>
                                <option value="DTE.DE">DTE.DE - 도이체텔레콤</option>
                                <option value="LIN.DE">LIN.DE - 린데</option>
                                <option value="BEI.DE">BEI.DE - 바이어스도르프</option>
                                <option value="HEN3.DE">HEN3.DE - 헨켈</option>
                            </optgroup>

                            <!-- Taiwanese Stocks -->
                            <optgroup label="🇹🇼 대만 주식">
                                <option value="2330.TW">2330.TW - 대만반도체(TSMC)</option>
                                <option value="2454.TW">2454.TW - 미디어텍</option>
                                <option value="2317.TW">2317.TW - 훙하이정밀</option>
                                <option value="2412.TW">2412.TW - 중화텔레콤</option>
                                <option value="1303.TW">1303.TW - 난야플라스틱</option>
                                <option value="2882.TW">2882.TW - 캐세이금융</option>
                                <option value="1326.TW">1326.TW - 포모사케미컬</option>
                                <option value="2408.TW">2408.TW - 난야테크놀로지</option>
                                <option value="2881.TW">2881.TW - 푸본금융</option>
                                <option value="3008.TW">3008.TW - 라간정밀</option>
                                <option value="2303.TW">2303.TW - 유나이티드마이크로일렉트로닉스</option>
                                <option value="2891.TW">2891.TW - CTBC금융</option>
                                <option value="6505.TW">6505.TW - 포모사페트로케미컬</option>
                                <option value="2207.TW">2207.TW - 호타이모터</option>
                                <option value="2886.TW">2886.TW - 메가금융</option>
                            </optgroup>

                            <!-- Cryptocurrencies -->
                            <optgroup label="₿ 암호화폐">
                                <option value="BTC-USD">BTC-USD - 비트코인</option>
                                <option value="ETH-USD">ETH-USD - 이더리움</option>
                                <option value="BNB-USD">BNB-USD - 바이낸스코인</option>
                                <option value="XRP-USD">XRP-USD - 리플</option>
                                <option value="ADA-USD">ADA-USD - 카르다노</option>
                                <option value="SOL-USD">SOL-USD - 솔라나</option>
                                <option value="DOT-USD">DOT-USD - 폴카닷</option>
                                <option value="DOGE-USD">DOGE-USD - 도지코인</option>
                                <option value="AVAX-USD">AVAX-USD - 아발란체</option>
                                <option value="SHIB-USD">SHIB-USD - 시바이누</option>
                                <option value="MATIC-USD">MATIC-USD - 폴리곤</option>
                                <option value="LTC-USD">LTC-USD - 라이트코인</option>
                                <option value="UNI-USD">UNI-USD - 유니스왑</option>
                                <option value="LINK-USD">LINK-USD - 체인링크</option>
                                <option value="ATOM-USD">ATOM-USD - 코스모스</option>
                                <option value="TRX-USD">TRX-USD - 트론</option>
                                <option value="NEAR-USD">NEAR-USD - 니어프로토콜</option>
                                <option value="ALGO-USD">ALGO-USD - 알고랜드</option>
                                <option value="VET-USD">VET-USD - 비체인</option>
                                <option value="ICP-USD">ICP-USD - 인터넷컴퓨터</option>
                                <option value="FTM-USD">FTM-USD - 팬텀</option>
                                <option value="HBAR-USD">HBAR-USD - 헤데라</option>
                                <option value="FIL-USD">FIL-USD - 파일코인</option>
                                <option value="ETC-USD">ETC-USD - 이더리움클래식</option>
                                <option value="XMR-USD">XMR-USD - 모네로</option>
                                <option value="XLM-USD">XLM-USD - 스텔라</option>
                                <option value="BCH-USD">BCH-USD - 비트코인캐시</option>
                                <option value="THETA-USD">THETA-USD - 테타</option>
                                <option value="SAND-USD">SAND-USD - 더샌드박스</option>
                                <option value="MANA-USD">MANA-USD - 디센트럴랜드</option>
                                <option value="AXS-USD">AXS-USD - 액시인피니티</option>
                                <option value="GRT-USD">GRT-USD - 더그래프</option>
                                <option value="ENJ-USD">ENJ-USD - 엔진코인</option>
                                <option value="CRV-USD">CRV-USD - 커브</option>
                                <option value="SUSHI-USD">SUSHI-USD - 스시스왑</option>
                            </optgroup>
                        </select>

                        <!-- Current Stock Info Display -->
                        <div id="stockInfo" class="hidden bg-tv-light/50 border border-tv-border rounded-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 id="selectedStockName" class="text-xl font-semibold text-tv-text"></h3>
                                    <p id="selectedStockSymbol" class="text-tv-text-secondary"></p>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm text-tv-text-secondary">현재 가격</p>
                                    <p id="currentStockPrice" class="text-3xl font-bold text-tv-text">$0.00</p>
                                    <p id="loadingPrice" class="text-sm text-tv-blue">
                                        <i class="fas fa-spinner fa-spin mr-1"></i>가격 로딩 중...
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Price Prediction -->
                    <div class="space-y-4">
                        <label class="block text-lg font-semibold text-tv-text">
                            <i class="fas fa-dollar-sign text-tv-green mr-2"></i>예측 정보
                        </label>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Current Price (Auto-filled) -->
                            <div>
                                <label class="block text-sm font-medium text-tv-text-secondary mb-2">현재 가격</label>
                                <input type="number" id="currentPrice" name="current_price" step="0.01" readonly
                                    class="w-full px-4 py-3 bg-tv-darker border border-tv-border rounded-lg text-tv-text cursor-not-allowed"
                                    placeholder="종목 선택 후 자동 입력">
                            </div>

                            <!-- Predicted Price (User Input) -->
                            <div>
                                <label class="block text-sm font-medium text-tv-text-secondary mb-2">예측 가격</label>
                                <input type="number" id="predictedPrice" name="predicted_price" step="0.01" required
                                    class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-green focus:border-tv-green transition-all"
                                    placeholder="예측하는 가격을 입력하세요">
                            </div>
                        </div>

                        <!-- Price Change Indicator -->
                        <div id="priceChangeIndicator"
                            class="hidden bg-tv-light/30 border border-tv-border rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <span class="text-tv-text-secondary">예상 변화율:</span>
                                <span id="priceChangePercent" class="font-bold text-lg"></span>
                                <span id="priceChangeDirection" class="text-sm font-medium"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Time Period -->
                    <div class="space-y-4">
                        <label class="block text-lg font-semibold text-tv-text">
                            <i class="fas fa-calendar text-tv-blue mr-2"></i>예측 기간
                        </label>

                        <select id="predictionDays" name="prediction_days" required
                            class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-blue focus:border-tv-blue transition-all">
                            <option value="">예측 기간을 선택하세요</option>
                            <option value="1">1일</option>
                            <option value="3">3일</option>
                            <option value="7">7일 (1주일)</option>
                            <option value="14">14일 (2주일)</option>
                            <option value="30">30일 (1개월)</option>
                        </select>

                        <!-- Target Date Display -->
                        <div id="targetDateDisplay"
                            class="hidden bg-tv-light/30 border border-tv-border rounded-lg p-3">
                            <div class="flex items-center justify-between">
                                <span class="text-tv-text-secondary">목표 날짜:</span>
                                <span id="targetDateText" class="font-semibold text-tv-text"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Optional: Analysis/Reasoning -->
                    <div class="space-y-4">
                        <label class="block text-lg font-semibold text-tv-text">
                            <i class="fas fa-lightbulb text-orange-500 mr-2"></i>예측 근거 (선택사항)
                        </label>

                        <textarea id="predictionReason" name="reasoning" rows="3"
                            class="w-full px-4 py-3 bg-tv-light border border-tv-border rounded-lg text-tv-text focus:ring-2 focus:ring-tv-blue focus:border-tv-blue transition-all resize-none"
                            placeholder="예측의 근거나 분석 내용을 간단히 작성해주세요 (선택사항)"></textarea>
                    </div>

                    <!-- Submit Button -->
                    <div class="pt-6">
                        <button type="submit" id="submitPrediction"
                            class="w-full bg-gradient-to-r from-tv-blue to-blue-600 hover:from-blue-600 hover:to-tv-blue text-white font-bold py-4 px-8 rounded-lg transition-all duration-300 transform hover:scale-[1.02] hover:shadow-lg hover:shadow-tv-blue/20 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:hover:shadow-none">
                            <i class="fas fa-rocket mr-2"></i>
                            <span id="submitButtonText">예측 발행하기</span>
                        </button>
                    </div>

                </form>
            </div>

            <!-- Success Message -->
            <div id="successMessage"
                class="hidden mt-8 bg-tv-green/20 border border-tv-green/30 rounded-lg p-6 text-center">
                <div class="flex items-center justify-center mb-4">
                    <div class="w-16 h-16 bg-tv-green/20 rounded-full flex items-center justify-center">
                        <i class="fas fa-check text-tv-green text-2xl"></i>
                    </div>
                </div>
                <h3 class="text-xl font-bold text-tv-green mb-2">예측이 성공적으로 발행되었습니다!</h3>
                <p class="text-tv-text-secondary mb-4">예측이 저장되었으며 다른 사용자들이 볼 수 있습니다.</p>
                <div class="flex gap-4 justify-center">
                    <button onclick="resetForm()"
                        class="bg-tv-blue hover:bg-blue-600 text-white px-6 py-2 rounded-lg transition-colors">
                        새 예측 작성
                    </button>
                    <a href="my-predictions.html"
                        class="bg-tv-green hover:bg-green-600 text-white px-6 py-2 rounded-lg transition-colors">
                        내 예측 보기
                    </a>
                </div>
            </div>

        </div>
    </main>

    <!-- JavaScript -->
    <script>
        // DOM elements
        const stockSearch = document.getElementById('stockSearch');
        const stockSelect = document.getElementById('stockSelect');
        const stockInfo = document.getElementById('stockInfo');
        const selectedStockName = document.getElementById('selectedStockName');
        const selectedStockSymbol = document.getElementById('selectedStockSymbol');
        const currentStockPrice = document.getElementById('currentStockPrice');
        const loadingPrice = document.getElementById('loadingPrice');
        const currentPrice = document.getElementById('currentPrice');
        const predictedPrice = document.getElementById('predictedPrice');
        const priceChangeIndicator = document.getElementById('priceChangeIndicator');
        const priceChangePercent = document.getElementById('priceChangePercent');
        const priceChangeDirection = document.getElementById('priceChangeDirection');
        const predictionDays = document.getElementById('predictionDays');
        const targetDateDisplay = document.getElementById('targetDateDisplay');
        const targetDateText = document.getElementById('targetDateText');
        const predictionForm = document.getElementById('predictionForm');
        const submitButton = document.getElementById('submitPrediction');
        const submitButtonText = document.getElementById('submitButtonText');
        const successMessage = document.getElementById('successMessage');

        // Function to determine market type based on symbol
        function getMarketType(symbol) {
            if (symbol.includes('-USD') || ['BTC', 'ETH', 'BNB', 'ADA', 'SOL', 'XRP', 'DOT', 'DOGE', 'AVAX', 'SHIB', 'MATIC', 'LTC', 'UNI', 'LINK', 'ATOM'].includes(symbol.split('-')[0])) {
                return 'crypto';
            } else if (symbol.includes('.KS')) {
                return 'kr_stock';
            } else if (symbol.includes('.T')) {
                return 'jp_stock';
            } else if (symbol.includes('.NS') || symbol.includes('.BO')) {
                return 'in_stock';
            } else if (symbol.includes('.L')) {
                return 'uk_stock';
            } else if (symbol.includes('.TO')) {
                return 'ca_stock';
            } else if (symbol.includes('.PA')) {
                return 'fr_stock';
            } else if (symbol.includes('.DE')) {
                return 'de_stock';
            } else if (symbol.includes('.TW')) {
                return 'tw_stock';
            } else {
                return 'us_stock';
            }
        }

        // Function to fetch stock price from backend API
        async function fetchStockPrice(symbol) {
            try {
                console.log(`Fetching price for symbol: ${symbol}`);

                // Determine market type
                const market = getMarketType(symbol);

                // Call the backend API to get stock price
                const response = await fetch(`/api/market-data/quote/${encodeURIComponent(symbol)}/?market=${market}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });

                if (response.ok) {
                    const data = await response.json();
                    console.log('Price data received:', data);

                    // Extract price from various possible fields
                    let price = data.price || data.current_price || data.regularMarketPrice || data.c || 0;

                    // Handle cases where price might be null or undefined
                    if (!price || price === 0) {
                        // Try to extract from nested data
                        if (data.quote && data.quote.price) {
                            price = data.quote.price;
                        } else if (data.data && data.data.price) {
                            price = data.data.price;
                        }
                    }

                    return {
                        price: parseFloat(price) || 0,
                        name: data.name || data.company_name || data.shortName || data.longName || getStockDisplayName(symbol),
                        symbol: symbol,
                        source: data.source || 'api',
                        is_sample: data.is_sample || false
                    };
                } else {
                    const errorText = await response.text();
                    console.error('Failed to fetch price:', response.status, response.statusText, errorText);
                    throw new Error(`Failed to fetch price for ${symbol}: ${response.status}`);
                }
            } catch (error) {
                console.error('Error fetching stock price:', error);
                // Return fallback data with price 0
                return {
                    price: 0,
                    name: getStockDisplayName(symbol),
                    symbol: symbol,
                    source: 'fallback',
                    is_sample: true
                };
            }
        }

        // Function to get display name from the selected option
        function getStockDisplayName(symbol) {
            const selectedOption = stockSelect.querySelector(`option[value="${symbol}"]`);
            if (selectedOption) {
                const fullText = selectedOption.textContent;
                // Extract company name (part after the " - ")
                const parts = fullText.split(' - ');
                return parts.length > 1 ? parts[1] : symbol;
            }
            return symbol;
        }

        // Stock search functionality
        stockSearch.addEventListener('input', function () {
            const searchTerm = this.value.toLowerCase();
            const options = stockSelect.querySelectorAll('option');

            options.forEach(option => {
                if (option.value === '') return;
                const text = option.textContent.toLowerCase();
                option.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Stock selection handler
        stockSelect.addEventListener('change', async function () {
            const selectedSymbol = this.value;

            if (selectedSymbol) {
                // Show loading state
                loadingPrice.style.display = 'block';
                currentStockPrice.textContent = '$0.00';
                stockInfo.classList.remove('hidden');

                // Update basic info immediately
                selectedStockName.textContent = getStockDisplayName(selectedSymbol);
                selectedStockSymbol.textContent = selectedSymbol;

                try {
                    // Fetch stock data from API
                    const stockData = await fetchStockPrice(selectedSymbol);

                    // Update UI with stock information
                    selectedStockName.textContent = stockData.name;
                    selectedStockSymbol.textContent = stockData.symbol;

                    // Format price based on symbol type and value
                    let formattedPrice;
                    if (stockData.price === 0) {
                        formattedPrice = '가격 정보 없음';
                        currentStockPrice.className = 'text-3xl font-bold text-tv-text-secondary';
                    } else if (selectedSymbol.includes('-USD') || getMarketType(selectedSymbol) === 'crypto') {
                        // Cryptocurrency formatting
                        if (stockData.price > 1) {
                            formattedPrice = `$${stockData.price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                        } else {
                            formattedPrice = `$${stockData.price.toFixed(6)}`;
                        }
                        currentStockPrice.className = 'text-3xl font-bold text-tv-green';
                    } else {
                        // Stock formatting
                        formattedPrice = `$${stockData.price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                        currentStockPrice.className = 'text-3xl font-bold text-tv-text';
                    }

                    currentStockPrice.textContent = formattedPrice;
                    currentPrice.value = stockData.price;

                    // Show data source if it's sample data
                    if (stockData.is_sample) {
                        const sourceIndicator = document.createElement('p');
                        sourceIndicator.className = 'text-xs text-tv-text-secondary mt-1';
                        sourceIndicator.textContent = '샘플 데이터 (실제 가격과 다를 수 있음)';
                        sourceIndicator.id = 'sourceIndicator';

                        // Remove existing source indicator
                        const existingIndicator = document.getElementById('sourceIndicator');
                        if (existingIndicator) {
                            existingIndicator.remove();
                        }

                        currentStockPrice.parentNode.appendChild(sourceIndicator);
                    } else {
                        // Remove source indicator if it exists
                        const existingIndicator = document.getElementById('sourceIndicator');
                        if (existingIndicator) {
                            existingIndicator.remove();
                        }
                    }

                    loadingPrice.style.display = 'none';

                    // Trigger price change calculation if predicted price exists
                    if (predictedPrice.value) {
                        calculatePriceChange();
                    }

                } catch (error) {
                    console.error('Error loading stock data:', error);
                    loadingPrice.style.display = 'none';
                    currentStockPrice.textContent = '가격 로딩 실패';
                    currentStockPrice.className = 'text-3xl font-bold text-tv-red';

                    // Still show basic info
                    selectedStockName.textContent = getStockDisplayName(selectedSymbol);
                    selectedStockSymbol.textContent = selectedSymbol;

                    // Allow user to manually enter current price
                    currentPrice.value = '';
                    currentPrice.readOnly = false;
                    currentPrice.placeholder = '현재 가격을 수동으로 입력하세요';
                }
            } else {
                stockInfo.classList.add('hidden');
                currentPrice.value = '';
                currentPrice.readOnly = true;
                currentPrice.placeholder = '종목 선택 후 자동 입력';
                priceChangeIndicator.classList.add('hidden');

                // Remove source indicator if it exists
                const existingIndicator = document.getElementById('sourceIndicator');
                if (existingIndicator) {
                    existingIndicator.remove();
                }
            }
        });

        // Predicted price input handler
        predictedPrice.addEventListener('input', calculatePriceChange);

        function calculatePriceChange() {
            const current = parseFloat(currentPrice.value);
            const predicted = parseFloat(predictedPrice.value);

            if (current && predicted) {
                const changePercent = ((predicted - current) / current) * 100;
                const isPositive = changePercent >= 0;

                priceChangePercent.textContent = `${isPositive ? '+' : ''}${changePercent.toFixed(2)}%`;
                priceChangePercent.className = `font-bold text-lg ${isPositive ? 'text-tv-green' : 'text-tv-red'}`;

                priceChangeDirection.textContent = isPositive ? '📈 상승 예측' : '📉 하락 예측';
                priceChangeDirection.className = `text-sm font-medium ${isPositive ? 'text-tv-green' : 'text-tv-red'}`;

                priceChangeIndicator.classList.remove('hidden');
            } else {
                priceChangeIndicator.classList.add('hidden');
            }
        }

        // Prediction days change handler
        predictionDays.addEventListener('change', function () {
            const days = parseInt(this.value);

            if (days) {
                const targetDate = new Date();
                targetDate.setDate(targetDate.getDate() + days);

                const options = {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'long'
                };

                targetDateText.textContent = targetDate.toLocaleDateString('ko-KR', options);
                targetDateDisplay.classList.remove('hidden');
            } else {
                targetDateDisplay.classList.add('hidden');
            }
        });

        // Form submission handler
        predictionForm.addEventListener('submit', async function (e) {
            e.preventDefault();

            // Disable submit button
            submitButton.disabled = true;
            submitButtonText.textContent = '발행 중...';
            submitButton.querySelector('i').className = 'fas fa-spinner fa-spin mr-2';

            try {
                // Calculate target date
                const targetDate = new Date();
                targetDate.setDate(targetDate.getDate() + parseInt(predictionDays.value));

                const formData = {
                    stock_symbol: stockSelect.value,
                    current_price: parseFloat(currentPrice.value),
                    predicted_price: parseFloat(predictedPrice.value),
                    target_date: targetDate.toISOString().split('T')[0], // YYYY-MM-DD format
                    reasoning: document.getElementById('predictionReason').value || 'User prediction',
                    confidence: 75
                };

                console.log('Submitting prediction:', formData);

                // Submit to API
                const response = await fetch('/api/charts/predictions/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken') || '',
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    const result = await response.json();
                    console.log('Prediction created:', result);

                    // Show success message
                    predictionForm.style.display = 'none';
                    successMessage.classList.remove('hidden');
                } else {
                    const error = await response.json();
                    throw new Error(error.detail || 'Failed to create prediction');
                }

            } catch (error) {
                console.error('Error submitting prediction:', error);
                alert('예측 발행 중 오류가 발생했습니다: ' + error.message);
            } finally {
                // Re-enable submit button
                submitButton.disabled = false;
                submitButtonText.textContent = '예측 발행하기';
                submitButton.querySelector('i').className = 'fas fa-rocket mr-2';
            }
        });

        // Reset form function
        function resetForm() {
            predictionForm.reset();
            stockInfo.classList.add('hidden');
            priceChangeIndicator.classList.add('hidden');
            targetDateDisplay.classList.add('hidden');
            successMessage.classList.add('hidden');
            predictionForm.style.display = 'block';
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            console.log('Prediction page loaded');
        });

        // CSRF Token helper function
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Mobile menu functions
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileMenuButton = document.getElementById('mobileMenuButton');

            if (mobileMenu.classList.contains('translate-x-full')) {
                // Open menu
                mobileMenu.classList.remove('translate-x-full');
                mobileMenu.classList.add('translate-x-0');
                mobileMenuButton.classList.add('menu-open');
                document.body.style.overflow = 'hidden';
            } else {
                // Close menu
                mobileMenu.classList.remove('translate-x-0');
                mobileMenu.classList.add('translate-x-full');
                mobileMenuButton.classList.remove('menu-open');
                document.body.style.overflow = 'auto';
            }
        }

        // Login modal function (placeholder)
        function showLoginModal() {
            alert('로그인 기능은 곧 구현될 예정입니다.');
        }

        // Add hamburger menu animation styles
        const style = document.createElement('style');
        style.textContent = `
            .hamburger-line {
                transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            }
            
            .menu-open .hamburger-line:nth-child(1) {
                transform: rotate(45deg) translate(6px, 6px);
            }
            
            .menu-open .hamburger-line:nth-child(2) {
                opacity: 0;
                transform: scale(0);
            }
            
            .menu-open .hamburger-line:nth-child(3) {
                transform: rotate(-45deg) translate(6px, -6px);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>

</html>