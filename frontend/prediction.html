<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>ì£¼ì‹ ì˜ˆì¸¡ - ì£¼ì‹ ì°¨íŠ¸</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“ˆ</text></svg>">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Korean Trading UI Design System -->
    <link rel="stylesheet" href="css/figma-design.css?v=2025.10.11">
    
    <!-- Mobile Trading UI -->
    <link rel="stylesheet" href="css/mobile-trading.css?v=2025.10.11">

    <script src="https://unpkg.com/lightweight-charts@4.1.3/dist/lightweight-charts.standalone.production.js"></script>
</head>

<body>
    <!-- Korean Trading UI Container -->
    <div class="figma-container prediction-page">
        
        <!-- Sidebar -->
        <aside class="figma-sidebar">
            <div class="sidebar-logo">
                <i class="fas fa-chart-line"></i>
                <span>ì£¼ì‹ ì°¨íŠ¸</span>
            </div>
            
            <nav class="sidebar-nav">
                <a href="/" class="nav-item">
                    <i class="fas fa-home"></i>
                    <span>í™ˆ</span>
                </a>
                <a href="charts.html" class="nav-item">
                    <i class="fas fa-chart-line"></i>
                    <span>ì°¨íŠ¸ ë¶„ì„</span>
                </a>
                <a href="prediction.html" class="nav-item active">
                    <i class="fas fa-bullseye"></i>
                    <span>ì‚¬ìš©ì ì˜ˆì¸¡</span>
                </a>
                <a href="ranking.html" class="nav-item">
                    <i class="fas fa-trophy"></i>
                    <span>ìˆ˜ìµë¥  ë­í‚¹</span>
                </a>
                <a href="subscription.html" class="nav-item">
                    <i class="fas fa-crown"></i>
                    <span>í”„ë¦¬ë¯¸ì—„</span>
                </a>
                <a href="events.html" class="nav-item">
                    <i class="fas fa-calendar"></i>
                    <span>ì´ë²¤íŠ¸</span>
                </a>
            </nav>
        </aside>
        
        <!-- Header -->
        <header class="figma-header prediction-header">
            <div class="header-logo">
                <i class="fas fa-chart-line text-accent-green"></i>
                <span>ì£¼ì‹ ì˜ˆì¸¡</span>
            </div>
            
            <div class="header-search">
                <input type="text" class="search-input" placeholder="ì˜ˆì¸¡í•  ì¢…ëª© ê²€ìƒ‰ (ì˜ˆ: BTC, ETH, AAPL, TSLA)" id="searchInput">
            </div>
            
            <div class="header-actions">
                <a href="#" class="btn-predict" id="signupButton"><i class="fas fa-user-plus"></i> íšŒì›ê°€ì…</a>
                <a href="#" class="btn-secondary" id="loginButton"><i class="fas fa-sign-in-alt"></i> ë¡œê·¸ì¸</a>
                <a href="buy-crypto.html" class="btn-secondary" id="buyCryptoButton"><i class="fas fa-bitcoin"></i> Buy Crypto</a>
            </div>
        </header>

        <!-- Main Content -->
        <main class="figma-main prediction-main">
            <div class="prediction-dashboard desktop-only">
                    <section class="dashboard-left">
                        <header class="dashboard-header">
                            <div class="profile-block">
                                <div class="profile-avatar">
                                    <span>ğŸŸ¢</span>
                                </div>
                                <div class="profile-meta">
                                    <div class="profile-name">SamsiteUR</div>
                                    <div class="profile-balance">ì‚¬ìš© ê°€ëŠ¥í•œ ìê¸ˆ <strong>$466,277.01</strong></div>
                                </div>
                            </div>
                            <div class="asset-meta">
                                <div class="asset-symbol">
                                    <span class="asset-tag">BTC/USD</span>
                                    <span class="asset-network">ë¹„íŠ¸ì½”ì¸ ë„¤íŠ¸ì›Œí¬</span>
                                </div>
                                <div class="asset-stats">
                                    <div class="asset-price">
                                        <span class="price-value" id="currentChartPrice">$432.32</span>
                                        <span class="price-delta positive" id="priceChangeDisplay">+2.34 (+0.20%)</span>
                                    </div>
                                    <div class="asset-timeframe">
                                        <span class="timeframe-label">ì‹œê°„ í”„ë ˆì„</span>
                                        <strong class="timeframe-value">1ì¼</strong>
                                    </div>
                                    <div class="asset-trend">
                                        <span class="trend-label">ë°©í–¥</span>
                                        <strong class="trend-value positive">ê°•ì„¸</strong>
                                    </div>
                                </div>
                            </div>
                            <div class="asset-controls">
                                <div class="chart-search-section compact">
                                    <input type="text" class="chart-search-input" placeholder="ì¢…ëª© ê²€ìƒ‰ (ì˜ˆ: AAPL, TSLA, BTC)" id="chartSearchInput">
                                    <div class="timeframe-controls">
                                        <button class="timeframe-control-btn active" data-period="1D">1D</button>
                                        <button class="timeframe-control-btn" data-period="1W">1W</button>
                                        <button class="timeframe-control-btn" data-period="1M">1M</button>
                                        <button class="timeframe-control-btn" data-period="1Y">1Y</button>
                                        <button class="timeframe-control-btn" data-period="5M">5M</button>
                                        <button class="timeframe-control-btn" data-period="1H">1H</button>
                                    </div>
                                </div>
                                <div class="chart-symbol-info">
                                    <span class="chart-symbol-name" id="chartSymbolName">BTC</span>
                                    <span class="chart-company-name">Bitcoin / USD</span>
                                </div>
                            </div>
                        </header>

                        <section class="chart-card card-dark">
                            <div class="tradingview-widget-container">
                                <div id="advanced_tradingview_chart"></div>
                            </div>
                            <div class="chart-navigation">
                                <div class="time-navigation">
                                    <button class="nav-btn" id="prevYear" title="ì´ì „ ë…„ë„">&lt;&lt;</button>
                                    <button class="nav-btn" id="prevMonth" title="ì´ì „ ë‹¬">&lt;</button>
                                    <span class="current-period" id="currentPeriod">2025ë…„ 10ì›”</span>
                                    <button class="nav-btn" id="nextMonth" title="ë‹¤ìŒ ë‹¬">&gt;</button>
                                    <button class="nav-btn" id="nextYear" title="ë‹¤ìŒ ë…„ë„">&gt;&gt;</button>
                                </div>
                                <div class="chart-scrollbar">
                                    <input type="range" class="time-slider" id="timeSlider" min="0" max="365" value="280" title="ì‹œê°„ íƒìƒ‰ - ê³¼ê±°/í˜„ì¬/ë¯¸ë˜">
                                    <div class="slider-labels">
                                        <span>ê³¼ê±°</span>
                                        <span>í˜„ì¬</span>
                                        <span>ë¯¸ë˜</span>
                                    </div>
                                </div>
                            </div>
                            <div class="volume-section">
                                <div class="volume-bars" id="volumeBars">
                                    <div class="volume-bar" style="height:68%"></div>
                                    <div class="volume-bar" style="height:82%"></div>
                                    <div class="volume-bar" style="height:45%"></div>
                                    <div class="volume-bar" style="height:78%"></div>
                                    <div class="volume-bar" style="height:92%"></div>
                                    <div class="volume-bar" style="height:61%"></div>
                                    <div class="volume-bar" style="height:54%"></div>
                                </div>
                                <div class="volume-legend">
                                    <span>ê±°ë˜ëŸ‰</span>
                                    <span>24h ê¸°ì¤€</span>
                                </div>
                            </div>
                            <div class="chart-tools-panel" style="display:none!important;">
                                <button class="tool-btn" id="addPoint" title="í¬ì¸íŠ¸ ì¶”ê°€"><i class="fas fa-plus"></i></button>
                                <button class="tool-btn" id="drawLine" title="ì¶”ì„¸ì„  ê·¸ë¦¬ê¸°"><i class="fas fa-chart-line"></i></button>
                                <button class="tool-btn" id="addNote" title="ë©”ëª¨ ì¶”ê°€"><i class="fas fa-sticky-note"></i></button>
                                <button class="tool-btn" id="clearAll" title="ëª¨ë“  ê·¸ë¦¬ê¸° ì‚­ì œ"><i class="fas fa-eraser"></i></button>
                            </div>
                        </section>

                        <section class="prediction-history card-dark">
                            <header class="history-header">
                                <div>
                                    <h2>ì˜ˆì¸¡ ë³´ë“œ</h2>
                                    <span class="history-sub">ìµœê·¼ ê±°ë˜ ë° ì˜ˆì¸¡ ê¸°ë¡</span>
                                </div>
                                <div class="history-filters">
                                    <button class="history-filter active">ì „ì²´</button>
                                    <button class="history-filter">ì„±ê³µ</button>
                                    <button class="history-filter">ì‹¤íŒ¨</button>
                                </div>
                            </header>
                            <div class="history-table">
                                <div class="history-row header">
                                    <span>ì´ë¦„</span>
                                    <span>ë‚ ì§œ</span>
                                    <span>ë§¤ìˆ˜/ë§¤ë„</span>
                                    <span>ì‹œê°„ í”„ë ˆì„</span>
                                    <span>ìˆ˜ìµë¥ </span>
                                </div>
                                <div class="history-row">
                                    <span>ì—˜ë¦¬ ì´ì•„ë¦¬ì—</span>
                                    <span>2025-10-05</span>
                                    <span class="chip buy">ë§¤ìˆ˜</span>
                                    <span>5ë¶„</span>
                                    <span class="profit negative">-3.17%</span>
                                </div>
                                <div class="history-row">
                                    <span>ì—˜ë¦¬ ì´ì•„ë¦¬ì—</span>
                                    <span>2025-10-05</span>
                                    <span class="chip buy">ë§¤ìˆ˜</span>
                                    <span>1ì¼</span>
                                    <span class="profit positive">+8.30%</span>
                                </div>
                                <div class="history-row">
                                    <span>ì—˜ë¦¬ ì´ì•„ë¦¬ì—</span>
                                    <span>2025-10-04</span>
                                    <span class="chip sell">ë§¤ë„</span>
                                    <span>5ë¶„</span>
                                    <span class="profit negative">-1.96%</span>
                                </div>
                                <div class="history-row">
                                    <span>ì—˜ë¦¬ ì´ì•„ë¦¬ì—</span>
                                    <span>2025-10-04</span>
                                    <span class="chip buy">ë§¤ìˆ˜</span>
                                    <span>1ì¼</span>
                                    <span class="profit positive">+8.30%</span>
                                </div>
                                <div class="history-row">
                                    <span>ì—˜ë¦¬ ì´ì•„ë¦¬ì—</span>
                                    <span>2025-10-03</span>
                                    <span class="chip sell">ë§¤ë„</span>
                                    <span>5ë¶„</span>
                                    <span class="profit negative">-3.17%</span>
                                </div>
                            </div>
                        </section>
                    </section>

                    <aside class="dashboard-right">
                        <div class="prediction-form-card card-dark">
                            <header class="form-header">
                                <div>
                                    <span class="form-tag">ì˜ˆì¸¡</span>
                                    <h2>í¬ì§€ì…˜ ì…ë ¥</h2>
                                </div>
                                <button class="form-settings"><i class="fas fa-ellipsis-h"></i></button>
                            </header>
                            <div class="form-tabs">
                                <button class="form-tab active" data-tab="prediction">ì£¼ì‹ ì˜ˆì¸¡</button>
                                <button class="form-tab" data-tab="start">ë¹ ë¥¸ ì‹œì‘</button>
                            </div>
                            <div class="form-body">
                                <label class="form-label-modern">ìì‚° ì„ íƒ</label>
                                <select class="form-control-modern" id="symbolSelect">
                                    <option value="">ì¢…ëª©ì„ ì„ íƒí•˜ì„¸ìš”</option>
                                    <option value="BTC/USD">BTC/USD - ë¹„íŠ¸ì½”ì¸</option>
                                    <option value="ETH/USD">ETH/USD - ì´ë”ë¦¬ì›€</option>
                                    <option value="AAPL">AAPL - ì• í”Œ</option>
                                    <option value="TSLA">TSLA - í…ŒìŠ¬ë¼</option>
                                    <option value="MSFT">MSFT - ë§ˆì´í¬ë¡œì†Œí”„íŠ¸</option>
                                    <option value="GOOGL">GOOGL - êµ¬ê¸€</option>
                                </select>

                                <label class="form-label-modern" for="periodSelect">ì˜ˆì¸¡ ê¸°ê°„</label>
                                <select class="form-control-modern" id="periodSelect">
                                    <option value="1d">1ì¼</option>
                                    <option value="3d">3ì¼</option>
                                    <option value="1w" selected>1ì£¼ì¼</option>
                                    <option value="1m">1ê°œì›”</option>
                                    <option value="3m">3ê°œì›”</option>
                                </select>

                                <label class="form-label-modern">í˜„ì¬ê°€</label>
                                <div class="form-value-display">$437.0</div>

                                <label class="form-label-modern">ìˆ˜ëŸ‰</label>
                                <input type="number" class="form-control-modern" placeholder="ìˆ˜ëŸ‰" value="10">

                                <label class="form-label-modern">ëª©í‘œê°€</label>
                                <input type="number" class="form-control-modern" id="targetPrice" placeholder="ì˜ˆìƒ ëª©í‘œ ê°€ê²©">

                                <label class="form-label-modern">ë©”ëª¨ (ì„ íƒ)</label>
                                <textarea class="form-control-modern" rows="3" placeholder="ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>

                                <div class="direction-buttons-modern">
                                    <button type="button" class="direction-btn-modern up" onclick="selectDirection('up')">
                                        <i class="fas fa-arrow-up"></i>
                                        <span>ìƒìŠ¹</span>
                                    </button>
                                    <button type="button" class="direction-btn-modern down" onclick="selectDirection('down')">
                                        <i class="fas fa-arrow-down"></i>
                                        <span>í•˜ë½</span>
                                    </button>
                                </div>

                                <button class="btn-predict-submit-modern" onclick="submitPrediction()">
                                    <i class="fas fa-plus-circle"></i>
                                    ì˜ˆì¸¡ ë“±ë¡
                                </button>
                            </div>
                        </div>

                        <div class="news-card card-dark">
                            <header class="news-header">
                                <h3>ìµœì‹  ë‰´ìŠ¤</h3>
                                <button class="news-refresh"><i class="fas fa-sync"></i></button>
                            </header>
                            <ul class="news-list">
                                <li>
                                    <span class="news-title">ìƒˆë¡œìš´ ê¸ˆìœµ ê·œì œê°€ ì‹œì¥ì„ í”ë“¤ë‹¤</span>
                                    <span class="news-time">2ë¶„ ì „</span>
                                </li>
                                <li>
                                    <span class="news-title">BTC ê¸‰ë“±, ì£¼ìš” ì €í•­ì„  ëŒíŒŒ</span>
                                    <span class="news-time">8ë¶„ ì „</span>
                                </li>
                                <li>
                                    <span class="news-title">ê¸°ê´€ íˆ¬ìì, ê¸°ìˆ ì£¼ ë§¤ìˆ˜ í™•ëŒ€ë¡œ ì „í™˜</span>
                                    <span class="news-time">12ë¶„ ì „</span>
                                </li>
                                <li>
                                    <span class="news-title">ë¯¸ ì—°ì¤€, ê¸ˆë¦¬ ë™ê²° ì‹œì‚¬</span>
                                    <span class="news-time">20ë¶„ ì „</span>
                                </li>
                                <li>
                                    <span class="news-title">ì²¨ë‹¨ ê¸°ìˆ  ì„¹í„°, ì¡°ì • í›„ ë°˜ë“± ì‹ í˜¸</span>
                                    <span class="news-time">30ë¶„ ì „</span>
                                </li>
                            </ul>
                        </div>
                    </aside>
                </div>

                <section class="prediction-mobile mobile-only">
                    <div class="mobile-hero-card mobile-fade-in">
                        <div class="mobile-hero-top">
                            <div>
                                <span class="mobile-hero-subtitle">ì•ˆë…•í•˜ì„¸ìš”,</span>
                                <span class="mobile-hero-title">SamsiteUR</span>
                            </div>
                            <button class="mobile-notification-btn" aria-label="ìƒˆ ì•Œë¦¼">
                                <i class="fas fa-bell"></i>
                                <span class="mobile-notification-dot"></span>
                            </button>
                        </div>
                        <div class="mobile-hero-balance">
                            <span class="label">ì´ ìì‚°</span>
                            <span class="value">â‚©164,500,000</span>
                        </div>
                        <div class="mobile-hero-card-info">
                            <div>
                                <span class="mobile-card-label">ì£¼ìš” ìì‚°</span>
                                <span class="mobile-card-value">BTC / USD</span>
                            </div>
                            <div class="mobile-card-change positive">+8.30%</div>
                        </div>
                        <div class="mobile-hero-card-meta">
                            <span class="mobile-card-number">**** 4821</span>
                            <span class="mobile-card-chip"></span>
                        </div>
                    </div>

                    <div class="mobile-quick-actions mobile-fade-in">
                        <button class="mobile-action-btn primary">
                            <i class="fas fa-bullseye"></i>
                            ì˜ˆì¸¡ ë“±ë¡
                        </button>
                        <button class="mobile-action-btn secondary">
                            <i class="fas fa-chart-line"></i>
                            ì°¨íŠ¸ ë³´ê¸°
                        </button>
                        <button class="mobile-action-btn tertiary">
                            <i class="fas fa-wallet"></i>
                            ìê¸ˆ ê´€ë¦¬
                        </button>
                    </div>

                    <div class="mobile-chart-container mobile-fade-in">
                        <div class="mobile-chart-header">
                            <div>
                                <div class="mobile-chart-symbol">BTC / USD</div>
                                <div class="mobile-chart-subtitle">ë¹„íŠ¸ì½”ì¸ ë„¤íŠ¸ì›Œí¬</div>
                            </div>
                            <div class="mobile-chart-price-wrap">
                                <span class="mobile-chart-price">$43,276</span>
                                <span class="mobile-chart-change positive">+3.12%</span>
                            </div>
                        </div>
                        <div class="mobile-chart-canvas" id="mobilePredictionChart"></div>
                        <div class="mobile-chart-timeframes">
                            <button class="mobile-timeframe-btn active" data-period="1D">1D</button>
                            <button class="mobile-timeframe-btn" data-period="1W">1W</button>
                            <button class="mobile-timeframe-btn" data-period="1M">1M</button>
                            <button class="mobile-timeframe-btn" data-period="1Y">1Y</button>
                        </div>
                    </div>

                    <div class="mobile-stats-grid mobile-fade-in">
                        <div class="mobile-stat-card">
                            <div class="mobile-stat-label">ì˜¤ëŠ˜ ìˆ˜ìµë¥ </div>
                            <div class="mobile-stat-value">+4.12%</div>
                            <div class="mobile-stat-change positive">ìƒìŠ¹ ì¶”ì„¸</div>
                        </div>
                        <div class="mobile-stat-card">
                            <div class="mobile-stat-label">ì˜ˆì¸¡ ì •í™•ë„</div>
                            <div class="mobile-stat-value">86%</div>
                            <div class="mobile-stat-change">ì§€ë‚œì£¼ ëŒ€ë¹„ +6%</div>
                        </div>
                    </div>

                    <div class="mobile-card mobile-wallet-card mobile-fade-in">
                        <div class="mobile-card-header">
                            <div>
                                <h3 class="mobile-card-title">í¬ì§€ì…˜ ì…ë ¥</h3>
                                <span class="mobile-card-subtitle">ìƒìŠ¹ / í•˜ë½ ì„ íƒ í›„ ëª©í‘œê°€ë¥¼ ì…ë ¥í•˜ì„¸ìš”</span>
                            </div>
                            <button class="mobile-card-action">ìƒˆ ì˜ˆì¸¡</button>
                        </div>
                        <div class="mobile-form-group">
                            <label class="mobile-form-label">ìì‚° ì„ íƒ</label>
                            <select class="mobile-form-select">
                                <option>BTC / USD</option>
                                <option>ETH / USD</option>
                                <option>AAPL</option>
                                <option>TSLA</option>
                            </select>
                        </div>
                        <div class="mobile-form-inline">
                            <div class="mobile-form-group">
                                <label class="mobile-form-label">ê¸°ê°„</label>
                                <select class="mobile-form-select">
                                    <option>1D</option>
                                    <option>1W</option>
                                    <option selected>1M</option>
                                    <option>3M</option>
                                </select>
                            </div>
                            <div class="mobile-form-group">
                                <label class="mobile-form-label">ëª©í‘œê°€</label>
                                <input type="number" class="mobile-form-input" placeholder="$45,000">
                            </div>
                        </div>
                        <div class="mobile-direction-toggle">
                            <button class="mobile-direction-btn up active"><i class="fas fa-arrow-up"></i> ìƒìŠ¹</button>
                            <button class="mobile-direction-btn down"><i class="fas fa-arrow-down"></i> í•˜ë½</button>
                        </div>
                        <button class="mobile-btn">ì˜ˆì¸¡ ì œì¶œ</button>
                    </div>

                    <div class="mobile-card mobile-fade-in">
                        <div class="mobile-card-header">
                            <h3 class="mobile-card-title">ìµœê·¼ ê±°ë˜</h3>
                            <button class="mobile-card-action">ì „ì²´ ë³´ê¸°</button>
                        </div>
                        <div class="mobile-history-list">
                            <div class="mobile-transaction-item">
                                <div class="mobile-list-icon"><i class="fas fa-coins"></i></div>
                                <div class="mobile-list-content">
                                    <div class="mobile-list-title">ë¹„íŠ¸ì½”ì¸ ë§¤ìˆ˜</div>
                                    <div class="mobile-transaction-meta">5ë¶„ ì „ Â· 1ì¼ ì˜ˆì¸¡</div>
                                </div>
                                <div class="mobile-list-value positive">+8.30%</div>
                            </div>
                            <div class="mobile-transaction-item">
                                <div class="mobile-list-icon"><i class="fas fa-chart-area"></i></div>
                                <div class="mobile-list-content">
                                    <div class="mobile-list-title">ì´ë”ë¦¬ì›€ ë§¤ë„</div>
                                    <div class="mobile-transaction-meta">32ë¶„ ì „ Â· 5ë¶„ ì˜ˆì¸¡</div>
                                </div>
                                <div class="mobile-list-value negative">-3.17%</div>
                            </div>
                            <div class="mobile-transaction-item">
                                <div class="mobile-list-icon"><i class="fas fa-rocket"></i></div>
                                <div class="mobile-list-content">
                                    <div class="mobile-list-title">í…ŒìŠ¬ë¼ ìƒìŠ¹</div>
                                    <div class="mobile-transaction-meta">ì–´ì œ Â· 1ì£¼ ì˜ˆì¸¡</div>
                                </div>
                                <div class="mobile-list-value positive">+4.52%</div>
                            </div>
                        </div>
                    </div>

                    <div class="mobile-card mobile-fade-in">
                        <div class="mobile-card-header">
                            <h3 class="mobile-card-title">ì‹œì¥ ë‰´ìŠ¤</h3>
                            <button class="mobile-card-action">ìƒˆë¡œê³ ì¹¨</button>
                        </div>
                        <ul class="mobile-news-list">
                            <li>
                                <span class="news-title">BTC ê¸‰ë“±, ì €í•­ì„  ëŒíŒŒ</span>
                                <span class="news-time">2ë¶„ ì „</span>
                            </li>
                            <li>
                                <span class="news-title">ç¾ ì—°ì¤€, ê¸ˆë¦¬ ë™ê²° ì‹œì‚¬</span>
                                <span class="news-time">12ë¶„ ì „</span>
                            </li>
                            <li>
                                <span class="news-title">ì²¨ë‹¨ ê¸°ìˆ  ì„¹í„°, ì¡°ì • í›„ ë°˜ë“± ì‹ í˜¸</span>
                                <span class="news-time">30ë¶„ ì „</span>
                            </li>
                        </ul>
                    </div>
                </section>
            </main>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-bottom-nav mobile-only" aria-label="ëª¨ë°”ì¼ í•˜ë‹¨ íƒìƒ‰">
        <a href="/" class="mobile-nav-item" title="í™ˆ">
            <i class="fas fa-home" aria-hidden="true"></i>
            <span>í™ˆ</span>
        </a>
        <a href="charts.html" class="mobile-nav-item" title="ì°¨íŠ¸">
            <i class="fas fa-chart-area" aria-hidden="true"></i>
            <span>ì°¨íŠ¸</span>
        </a>
        <a href="prediction.html" class="mobile-nav-item active" title="ì˜ˆì¸¡" aria-current="page">
            <i class="fas fa-magic" aria-hidden="true"></i>
            <span>ì˜ˆì¸¡</span>
        </a>
        <a href="ranking.html" class="mobile-nav-item" title="ë­í‚¹">
            <i class="fas fa-trophy" aria-hidden="true"></i>
            <span>ë­í‚¹</span>
        </a>
        <a href="subscription.html" class="mobile-nav-item" title="í”„ë¦¬ë¯¸ì—„">
            <i class="fas fa-crown" aria-hidden="true"></i>
            <span>í”„ë¦¬ë¯¸ì—„</span>
        </a>
    </nav>

    <!-- JavaScript -->
    <script src="js/social-auth.js?v=2025.10.13"></script>
    <script src="js/auth-ui.js?v=2025.10.13"></script>
    <script>
        let predictionSignupAuth = null;

        function setAuthButtonState(buttonId, isLoading, defaultText, completeText) {
            const btn = document.getElementById(buttonId);
            if (!btn) return;
            btn.classList.toggle('loading', isLoading);
            btn.innerHTML = isLoading ? '<i class="fas fa-spinner fa-spin"></i> ì§„í–‰ ì¤‘...' : defaultText;
            if (!isLoading && completeText) {
                btn.innerHTML = completeText;
            }
        }

        function ensureCredentialsModal() {
            if (document.getElementById('credentialsModal')) {
                return;
            }

            const overlay = document.createElement('div');
            overlay.id = 'credentialsModal';
            overlay.className = 'auth-modal-overlay hidden';
            overlay.innerHTML = `
                <div class="auth-modal" role="dialog" aria-modal="true">
                    <button type="button" class="auth-modal-close" data-close>&times;</button>
                    <h2 class="auth-modal-title">ë¡œê·¸ì¸</h2>
                    <p class="auth-modal-subtitle">ê¸°ì¡´ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì„¸ìš”.</p>
                    <form id="credentialsLoginForm" class="auth-modal-form">
                        <label class="auth-modal-label" for="credentialsEmail">ì´ë©”ì¼</label>
                        <input type="email" id="credentialsEmail" class="auth-modal-input" required placeholder="you@example.com">
                        <label class="auth-modal-label" for="credentialsPassword">ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" id="credentialsPassword" class="auth-modal-input" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                        <div id="credentialsMessage" class="auth-modal-message" role="alert" aria-live="polite"></div>
                        <button type="submit" class="auth-modal-submit" id="credentialsSubmit">
                            <i class="fas fa-sign-in-alt"></i> ë¡œê·¸ì¸
                        </button>
                    </form>
                </div>
            `;

            overlay.addEventListener('click', function(e){
                if (e.target === overlay) {
                    closeCredentialsModal();
                }
            });

            overlay.querySelector('[data-close]').addEventListener('click', closeCredentialsModal);

            overlay.querySelector('#credentialsLoginForm').addEventListener('submit', handleCredentialsLogin);

            document.body.appendChild(overlay);
        }

        function openCredentialsModal() {
            ensureCredentialsModal();
            const overlay = document.getElementById('credentialsModal');
            overlay.classList.remove('hidden');
            document.body.classList.add('modal-open');
            const emailField = document.getElementById('credentialsEmail');
            if (emailField) {
                setTimeout(() => emailField.focus(), 50);
            }
        }

        function closeCredentialsModal() {
            const overlay = document.getElementById('credentialsModal');
            if (!overlay) return;
            overlay.classList.add('hidden');
            document.body.classList.remove('modal-open');
            const form = document.getElementById('credentialsLoginForm');
            if (form) {
                form.reset();
            }
            const message = document.getElementById('credentialsMessage');
            if (message) {
                message.textContent = '';
                message.className = 'auth-modal-message';
            }
            const submit = document.getElementById('credentialsSubmit');
            if (submit) {
                submit.disabled = false;
                submit.innerHTML = '<i class="fas fa-sign-in-alt"></i> ë¡œê·¸ì¸';
            }
        }

        function getCSRFToken() {
            const match = document.cookie.match(/csrftoken=([^;]+)/);
            return match ? decodeURIComponent(match[1]) : '';
        }

        async function handleCredentialsLogin(event) {
            event.preventDefault();
            const email = document.getElementById('credentialsEmail').value.trim();
            const password = document.getElementById('credentialsPassword').value;
            const message = document.getElementById('credentialsMessage');
            const submit = document.getElementById('credentialsSubmit');

            if (!email || !password) {
                message.textContent = 'ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                message.classList.add('error');
                return;
            }

            submit.disabled = true;
            submit.innerHTML = '<i class="fas fa-spinner fa-spin"></i> í™•ì¸ ì¤‘';
            message.textContent = '';
            message.className = 'auth-modal-message';

            try {
                const response = await fetch('/api/auth/login/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }

                if (data.access_token) {
                    localStorage.setItem('access_token', data.access_token);
                    if (data.user) {
                        localStorage.setItem('user', JSON.stringify(data.user));
                    }
                }

                message.textContent = data.message || 'ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.';
                message.classList.add('success');
                submit.innerHTML = '<i class="fas fa-check"></i> ì™„ë£Œ';

                setTimeout(() => {
                    closeCredentialsModal();
                    window.location.reload();
                }, 800);

            } catch (error) {
                message.textContent = error.message;
                message.classList.add('error');
                submit.disabled = false;
                submit.innerHTML = '<i class="fas fa-sign-in-alt"></i> ë¡œê·¸ì¸';
            }
        }

        document.addEventListener('DOMContentLoaded', function(){
            const loginBtn = document.getElementById('loginButton');
            const signupBtn = document.getElementById('signupButton');

            predictionSignupAuth = new SocialAuthManager({
                baseUrl: '/api/auth',
                onStart: function () {
                    setAuthButtonState('signupButton', true, '<i class="fas fa-user-plus"></i> íšŒì›ê°€ì…');
                },
                onSuccess: function () {
                    setAuthButtonState('signupButton', false, '<i class="fas fa-user-plus"></i> íšŒì›ê°€ì…', '<i class="fas fa-check"></i> ì™„ë£Œ');
                    window.location.href = '/';
                },
                onError: function (error) {
                    setAuthButtonState('signupButton', false, '<i class="fas fa-user-plus"></i> íšŒì›ê°€ì…');
                    alert(`Google íšŒì›ê°€ì… ì‹œì‘ ì¤‘ ì˜¤ë¥˜: ${error.message}`);
                }
            });

            if (signupBtn) {
                signupBtn.addEventListener('click', function(e){
                    e.preventDefault();
                    if (!predictionSignupAuth) {
                        alert('íšŒì›ê°€ì… ì‹œìŠ¤í…œì„ ì´ˆê¸°í™”í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                        return;
                    }
                    // Request frontend redirect so the callback returns to prediction.html with tokens
                    const url = '/api/auth/social/google/login/?redirect=true&frontend_redirect=true';
                    setAuthButtonState('signupButton', true, '<i class="fas fa-user-plus"></i> íšŒì›ê°€ì…');
                    window.location.href = url;
                });
            }

            if (loginBtn) {
                loginBtn.addEventListener('click', function(e){
                    e.preventDefault();
                    openCredentialsModal();
                });
            }
        });

        // Ensure mobile nav active state reflects current page
        (function () {
            var path = location.pathname.replace(/\/+$/, '') || '/';
            document.querySelectorAll('.mobile-bottom-nav .mobile-nav-item').forEach(function(a){
                var href = a.getAttribute('href');
                var match = (href === '/' && path === '/') || (href !== '/' && path.endsWith(href));
                a.classList.toggle('active', !!match);
                if (match) a.setAttribute('aria-current', 'page');
            });
        })();

        // Minimal mobile prediction chart init as a fallback
        function initMobilePredictionChart() {
            var el = document.getElementById('mobilePredictionChart');
            if (!el || typeof LightweightCharts === 'undefined') return;
            if (el.__chartInit) return; // prevent double init
            el.__chartInit = true;
            var chart = LightweightCharts.createChart(el, {
                width: el.clientWidth,
                height: 180,
                layout: { background: { type: 'solid', color: '#0b1224' }, textColor: '#eaf2ff' },
                grid: { vertLines: { color: 'rgba(255,255,255,0.06)' }, horzLines: { color: 'rgba(255,255,255,0.06)' }},
                rightPriceScale: { borderColor: 'rgba(255,255,255,0.1)' },
                timeScale: { borderColor: 'rgba(255,255,255,0.1)' }
            });
            var series = chart.addAreaSeries({ lineColor: '#0A84FF', topColor: 'rgba(10,132,255,0.35)', bottomColor: 'rgba(10,132,255,0.05)' });
            var now = Date.now();
            var data = Array.from({length: 50}, (_, i) => ({ time: Math.floor((now/1000) - (50-i)*3600), value: 43000 + Math.sin(i/5)*300 + i*5 }));
            series.setData(data);
            chart.timeScale().fitContent();
            window.addEventListener('resize', function(){ chart.applyOptions({ width: el.clientWidth }); });
        }

        // Delay init to ensure CSS layout applied
        document.addEventListener('DOMContentLoaded', function(){ setTimeout(initMobilePredictionChart, 100); });

        // Handle tokens passed via URL fragment after social login
        (function handleAuthFromFragment(){
            try {
                if (!location.hash) return;
                // Cookie mode success path: #login=success
                if (location.hash.startsWith('#login=')) {
                    var params = new URLSearchParams(location.hash.substring(1));
                    var status = params.get('login');
                    var reason = params.get('reason');
                    // Clean the hash from the URL
                    history.replaceState(null, '', location.pathname + location.search);
                    if (status === 'success') {
                        // If cookie mode is active, the browser now holds HttpOnly cookies. Just reload.
                        setTimeout(function(){ window.location.reload(); }, 200);
                        return;
                    }
                    if (status === 'error') {
                        var msg = 'ì†Œì…œ ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                        if (reason === 'social_auth_error') msg = 'ì†Œì…œ ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                        if (reason === 'server_error') msg = 'ì„œë²„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                        alert(msg);
                        return;
                    }
                    return;
                }
                if (!location.hash.startsWith('#auth=')) return;
                const payload = decodeURIComponent(location.hash.substring(6));
                const data = JSON.parse(payload);
                if (data && data.access) {
                    localStorage.setItem('access_token', data.access);
                    if (data.refresh) localStorage.setItem('refresh_token', data.refresh);
                    if (data.user) localStorage.setItem('user', JSON.stringify(data.user));
                    // Clean the hash from the URL without reloading
                    history.replaceState(null, '', location.pathname + location.search);
                    // Update UI quickly
                    const sb = document.getElementById('signupButton');
                    if (sb) sb.innerHTML = '<i class="fas fa-check"></i> ì™„ë£Œ';
                    // Optionally reload to reflect logged-in state across the app
                    setTimeout(function(){ window.location.reload(); }, 400);
                }
            } catch (e) { console.error('Auth fragment parse error', e); }
        })();

        let selectedDirection = null;

        function selectDirection(direction) {
            selectedDirection = direction;
            document.querySelectorAll('.direction-btn-modern').forEach(btn => btn.classList.remove('selected'));
            document.querySelector(`.direction-btn-modern.${direction}`).classList.add('selected');
        }

        function submitPrediction() {
            const symbol = document.getElementById('symbolSelect').value;
            const period = document.getElementById('periodSelect').value;
            const targetPrice = document.getElementById('targetPrice').value;

            if (!symbol || !selectedDirection || !targetPrice) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // Show loading state
            const btn = document.querySelector('.btn-predict-submit-modern');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ë¶„ì„ ì¤‘...';
            btn.disabled = true;

            // Simulate prediction processing
            setTimeout(() => {
                alert(`${symbol} ${selectedDirection === 'up' ? 'ìƒìŠ¹' : 'í•˜ë½'} ì˜ˆì¸¡ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!`);
                btn.innerHTML = '<i class="fas fa-chart-line"></i> ì˜ˆì¸¡ ì œì¶œ';
                btn.disabled = false;
                
                // Reset form
                document.getElementById('symbolSelect').value = '';
                document.getElementById('targetPrice').value = '';
                selectedDirection = null;
                document.querySelectorAll('.direction-btn-modern').forEach(btn => btn.classList.remove('selected'));
            }, 2000);
        }

        // Search functionality (header search may not exist on all layouts)
        const headerSearchInput = document.getElementById('searchInput');
        if (headerSearchInput) {
            headerSearchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const symbol = this.value.toUpperCase();
                    if (symbol) {
                        document.getElementById('symbolSelect').value = symbol;
                        const activeInterval = document.querySelector('.timeframe-control-btn.active').dataset.period;
                        initializeAdvancedChart(symbol, convertPeriodToInterval(activeInterval));
                        updatePriceInfo(symbol);
                        if (typeof updateMobilePredictionChart === 'function') {
                            updateMobilePredictionChart(symbol);
                        }
                    }
                    this.value = '';
                }
            });
        }
    </script>

    <!-- TradingView Chart Widget -->
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js?v=20240108"></script>
    
    <!-- Advanced Chart JavaScript -->
    <script src="js/advanced-chart.js?v=20240108&t=1738983456"></script>

    <!-- Collapsible Sidebar Script -->
    <script src="js/collapsible-sidebar.js?v=20240108&t=1738983456"></script>
</body>
</html>
