<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradingView 휠 기능 테스트</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .chart-container {
            width: 100%;
            height: 400px;
            border: 2px solid #ccc;
            position: relative;
            background: #f9f9f9;
            cursor: crosshair;
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #666;
        }
        .instructions {
            background: #e8f4fd;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🔄 TradingView 마우스 휠 기능 테스트</h1>
        
        <div class="instructions">
            <h3>테스트 방법:</h3>
            <ol>
                <li><strong>마우스 휠</strong>: 차트 위에서 마우스 휠을 굴려보세요 (수평 스크롤)</li>
                <li><strong>Ctrl + 마우스 휠</strong>: Ctrl키를 누르고 휠을 굴려보세요 (줌 인/아웃)</li>
                <li><strong>키보드 단축키</strong>:
                    <ul>
                        <li>Ctrl + Plus(+): 줌 인</li>
                        <li>Ctrl + Minus(-): 줌 아웃</li>
                        <li>Ctrl + 0: 줌 리셋</li>
                    </ul>
                </li>
            </ol>
        </div>
        
        <div class="chart-container" id="testChart">
            TradingView 스타일 차트 영역<br>
            마우스를 올리고 휠을 테스트해보세요
        </div>
        
        <div class="status" id="statusLog">
            상태: 대기 중...
        </div>
        
        <div style="margin-top: 20px;">
            <button onclick="testZoomIn()">🔍+ 줌 인</button>
            <button onclick="testZoomOut()">🔍- 줌 아웃</button>
            <button onclick="testReset()">🔄 리셋</button>
        </div>
    </div>

    <script>
        let zoomLevel = 1.0;
        let scrollPosition = 0;
        const statusLog = document.getElementById('statusLog');
        const chartContainer = document.getElementById('testChart');
        
        function updateStatus(message) {
            statusLog.textContent = `상태: ${message}`;
            console.log(message);
        }
        
        // TradingView 스타일 휠 이벤트 핸들러
        chartContainer.addEventListener('wheel', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const delta = e.deltaY;
            const isCtrlPressed = e.ctrlKey || e.metaKey;
            
            if (isCtrlPressed) {
                // Zoom functionality
                const zoomFactor = delta > 0 ? 0.9 : 1.1;
                zoomLevel = Math.max(0.1, Math.min(5.0, zoomLevel * zoomFactor));
                updateStatus(`줌 레벨: ${(zoomLevel * 100).toFixed(0)}% (Ctrl+휠)`);
                showZoomIndicator(zoomLevel);
            } else {
                // Scroll functionality
                scrollPosition += delta > 0 ? 30 : -30;
                scrollPosition = Math.max(0, scrollPosition);
                updateStatus(`스크롤 위치: ${scrollPosition}px (휠 스크롤)`);
            }
        }, { passive: false });
        
        // 키보드 단축키
        document.addEventListener('keydown', function(e) {
            if (!chartContainer.matches(':hover')) return;
            
            if (e.ctrlKey || e.metaKey) {
                switch(e.code) {
                    case 'Equal':
                    case 'NumpadAdd':
                        e.preventDefault();
                        testZoomIn();
                        break;
                    case 'Minus':
                    case 'NumpadSubtract':
                        e.preventDefault();
                        testZoomOut();
                        break;
                    case 'Digit0':
                    case 'Numpad0':
                        e.preventDefault();
                        testReset();
                        break;
                }
            }
        });
        
        function testZoomIn() {
            zoomLevel = Math.min(5.0, zoomLevel * 1.1);
            updateStatus(`줌 인: ${(zoomLevel * 100).toFixed(0)}%`);
            showZoomIndicator(zoomLevel);
        }
        
        function testZoomOut() {
            zoomLevel = Math.max(0.1, zoomLevel * 0.9);
            updateStatus(`줌 아웃: ${(zoomLevel * 100).toFixed(0)}%`);
            showZoomIndicator(zoomLevel);
        }
        
        function testReset() {
            zoomLevel = 1.0;
            scrollPosition = 0;
            updateStatus(`리셋 완료: 줌 100%, 스크롤 0px`);
            showZoomIndicator(1.0, 'Reset');
        }
        
        function showZoomIndicator(zoom, action = 'Zoom') {
            // Remove existing indicator
            const existing = document.querySelector('.zoom-indicator');
            if (existing) existing.remove();
            
            // Create new indicator
            const indicator = document.createElement('div');
            indicator.className = 'zoom-indicator';
            indicator.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 8px 16px;
                border-radius: 20px;
                font-size: 12px;
                font-weight: 600;
                z-index: 10000;
                pointer-events: none;
            `;
            indicator.textContent = `${action}: ${(zoom * 100).toFixed(0)}%`;
            
            document.body.appendChild(indicator);
            
            // Auto-remove
            setTimeout(() => {
                if (indicator.parentElement) {
                    indicator.remove();
                }
            }, 2000);
        }
        
        updateStatus('TradingView 휠 기능 테스트 준비 완료');
    </script>
</body>
</html>