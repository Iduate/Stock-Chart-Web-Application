/* Mobile Chart Display Fixes
   Specific fixes for chart visibility and rendering issues on mobile devices
*/

/* Force chart containers to be visible on mobile */
@media (max-width: 768px) {

    .chart-container,
    .chart-container-hero,
    .featured-chart-container,
    #heroChart,
    #featuredChart {
        /* Force visibility */
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;

        /* Prevent layout issues */
        position: relative !important;
        width: 100% !important;
        height: 300px !important;
        max-width: 100% !important;
        overflow: hidden !important;

        /* Ensure proper background */
        background: #ffffff !important;
        border: 1px solid #e1e5e9 !important;
        border-radius: 8px !important;

        /* Mobile touch optimization */
        touch-action: pan-x pan-y !important;
        -webkit-overflow-scrolling: touch !important;
    }

    /* Critical canvas fixes for mobile */
    .chart-container canvas,
    .chart-container-hero canvas,
    .featured-chart-container canvas,
    #heroChart canvas,
    #featuredChart canvas,
    canvas {
        /* Force canvas visibility */
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;

        /* Proper canvas positioning */
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;

        /* Mobile optimization */
        transform: none !important;
        -webkit-transform: none !important;
        pointer-events: auto !important;
        touch-action: auto !important;

        /* Prevent canvas from being hidden */
        z-index: 1 !important;
    }

    /* Mobile chart wrapper fixes */
    .main-chart-section,
    .hero-image {
        width: 100% !important;
        overflow: visible !important;
        padding: 0 16px !important;
        margin: 0 !important;
    }

    /* Section container fixes */
    .container {
        width: 100% !important;
        max-width: 100% !important;
        padding: 0 16px !important;
        overflow-x: hidden !important;
    }
}

/* Extra small mobile devices */
@media (max-width: 480px) {

    .chart-container,
    .chart-container-hero,
    .featured-chart-container,
    #heroChart,
    #featuredChart {
        height: 280px !important;
        min-height: 280px !important;
    }

    /* Reduce padding on very small screens */
    .main-chart-section,
    .hero-image,
    .container {
        padding: 0 12px !important;
    }

    /* Ensure chart controls don't overflow */
    .chart-control-row {
        flex-wrap: wrap !important;
        gap: 8px !important;
        margin-top: 12px !important;
    }

    .chart-timeframes {
        flex-wrap: wrap !important;
        gap: 6px !important;
    }

    .btn.btn-timeframe {
        font-size: 12px !important;
        padding: 6px 10px !important;
        min-width: auto !important;
    }
}

/* Landscape orientation mobile fixes */
@media (max-height: 500px) and (orientation: landscape) {

    .chart-container,
    .chart-container-hero,
    .featured-chart-container,
    #heroChart,
    #featuredChart {
        height: 200px !important;
        min-height: 200px !important;
    }
}

/* Dark theme mobile fixes */
@media (prefers-color-scheme: dark) and (max-width: 768px) {

    .chart-container,
    .chart-container-hero,
    .featured-chart-container {
        background: #1e1e1e !important;
        border-color: #404040 !important;
    }

    .chart-legend {
        background: rgba(42, 46, 57, 0.95) !important;
        border-color: #404040 !important;
        color: #ffffff !important;
    }
}

/* Loading overlay mobile fixes */
@media (max-width: 768px) {
    .chart-loading-overlay {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        background: rgba(255, 255, 255, 0.9) !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        justify-content: center !important;
        z-index: 1000 !important;
        border-radius: 8px !important;
    }

    .chart-loading-spinner {
        width: 32px !important;
        height: 32px !important;
        border: 3px solid #f3f3f3 !important;
        border-top: 3px solid #2962FF !important;
        border-radius: 50% !important;
        animation: spin 1s linear infinite !important;
    }

    .chart-loading-text {
        margin-top: 12px !important;
        font-size: 14px !important;
        color: #666 !important;
        text-align: center !important;
    }
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

/* iOS Safari specific fixes */
@supports (-webkit-overflow-scrolling: touch) {
    @media (max-width: 768px) {

        .chart-container,
        .chart-container-hero,
        .featured-chart-container,
        #heroChart,
        #featuredChart {
            -webkit-transform: translateZ(0) !important;
            transform: translateZ(0) !important;
            will-change: transform !important;
        }

        canvas {
            -webkit-transform: translateZ(0) !important;
            transform: translateZ(0) !important;
            will-change: transform !important;
        }
    }
}